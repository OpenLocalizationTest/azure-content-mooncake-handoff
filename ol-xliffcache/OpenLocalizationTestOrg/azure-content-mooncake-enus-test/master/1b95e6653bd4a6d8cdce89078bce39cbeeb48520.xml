{
  "nodes": [
    {
      "content": "服务总线 和 Python 与 AMQP 1.0 | Azure",
      "pos": [
        27,
        59
      ]
    },
    {
      "content": "使用 AMQP 通过 Python 使用服务总线。",
      "pos": [
        77,
        102
      ]
    },
    {
      "content": "使用 AMQP 1.0 通过 Python 使用服务总线",
      "pos": [
        316,
        344
      ]
    },
    {
      "content": "Proton-Python 是绑定到 Proton-C 的 Python 语言；也就是说，Proton-Python 是作为 C 中实现的引擎周围的包装器实现的。",
      "pos": [
        433,
        514
      ]
    },
    {
      "content": "下载 Proton 客户端库",
      "pos": [
        519,
        533
      ]
    },
    {
      "pos": [
        535,
        685
      ],
      "content": "你可以从 <bpt id=\"p1\">[</bpt>http://qpid.apache.org/download.html<ept id=\"p1\">](http://qpid.apache.org/download.html)</ept> 下载 Proton-C 及其关联的绑定（包括 Python）。此下载采用源代码格式。若要生成代码，请按照已下载的程序包中包含的说明操作。"
    },
    {
      "content": "请注意，在撰写本文时，Proton-C 中的 SSL 支持仅适用于 Linux 操作系统。由于 Azure 服务总线需要使用 SSL，目前，Proton-C（及语言绑定）只能用于从 Linux 访问服务总线。对 Windows 上的 SSL 启用 Proton-C 的开发工作正在进行中，因此请经常返回查看是否有更新。",
      "pos": [
        687,
        846
      ]
    },
    {
      "content": "通过 Python 使用服务总线队列、主题和订阅",
      "pos": [
        851,
        875
      ]
    },
    {
      "content": "以下代码演示如何从服务总线消息实体发送和接收消息。",
      "pos": [
        877,
        902
      ]
    },
    {
      "content": "使用 Proton-Python 发送消息",
      "pos": [
        908,
        929
      ]
    },
    {
      "content": "以下代码演示如何向服务总线消息实体发送消息。",
      "pos": [
        931,
        953
      ]
    },
    {
      "content": "使用 Proton-Python 接收消息",
      "pos": [
        1192,
        1213
      ]
    },
    {
      "content": "以下代码演示如何从服务总线消息实体接收消息。",
      "pos": [
        1215,
        1237
      ]
    },
    {
      "content": "在 .NET 和 Proton-Python 之间进行消息传递",
      "pos": [
        1521,
        1552
      ]
    },
    {
      "content": "应用程序属性",
      "pos": [
        1558,
        1564
      ]
    },
    {
      "content": "Proton-Python 到服务总线 .NET API",
      "pos": [
        1571,
        1599
      ]
    },
    {
      "pos": [
        1601,
        1722
      ],
      "content": "Proton-Python 消息支持以下类型的应用程序属性：<bpt id=\"p1\">**</bpt>int<ept id=\"p1\">**</ept>、<bpt id=\"p2\">**</bpt>long<ept id=\"p2\">**</ept>、<bpt id=\"p3\">**</bpt>float<ept id=\"p3\">**</ept>、<bpt id=\"p4\">**</bpt>uuid<ept id=\"p4\">**</ept>、<bpt id=\"p5\">**</bpt>bool<ept id=\"p5\">**</ept>、<bpt id=\"p6\">**</bpt>string<ept id=\"p6\">**</ept>。以下 Python 代码显示如何使用上述每种属性类型在消息上设置属性。"
    },
    {
      "pos": [
        1962,
        2067
      ],
      "content": "在服务总线 .NET API 中，在 <bpt id=\"p1\">[</bpt>BrokeredMessage<ept id=\"p1\">][]</ept> 的 <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept> 集合中携带消息应用程序属性。以下代码演示如何读取从 Python 客户端收到的消息的应用程序属性。"
    },
    {
      "content": "下表将 Python 属性类型映射到 .NET 属性类型。",
      "pos": [
        2324,
        2353
      ]
    },
    {
      "content": "Python 属性类型",
      "pos": [
        2357,
        2368
      ]
    },
    {
      "content": ".NET 属性类型",
      "pos": [
        2371,
        2380
      ]
    },
    {
      "content": "int",
      "pos": [
        2431,
        2434
      ]
    },
    {
      "content": "int",
      "pos": [
        2437,
        2440
      ]
    },
    {
      "content": "float",
      "pos": [
        2445,
        2450
      ]
    },
    {
      "content": "double",
      "pos": [
        2453,
        2459
      ]
    },
    {
      "content": "long",
      "pos": [
        2464,
        2468
      ]
    },
    {
      "content": "int64",
      "pos": [
        2471,
        2476
      ]
    },
    {
      "content": "uuid",
      "pos": [
        2481,
        2485
      ]
    },
    {
      "content": "guid",
      "pos": [
        2488,
        2492
      ]
    },
    {
      "content": "bool",
      "pos": [
        2497,
        2501
      ]
    },
    {
      "content": "bool",
      "pos": [
        2504,
        2508
      ]
    },
    {
      "content": "字符串",
      "pos": [
        2513,
        2516
      ]
    },
    {
      "content": "字符串",
      "pos": [
        2519,
        2522
      ]
    },
    {
      "content": "服务总线 .NET API 到 Proton-Python",
      "pos": [
        2531,
        2560
      ]
    },
    {
      "pos": [
        2562,
        2854
      ],
      "content": "<bpt id=\"p1\">[</bpt>BrokeredMessage<ept id=\"p1\">][]</ept> 类型支持以下类型的应用程序属性：<bpt id=\"p2\">**</bpt>byte<ept id=\"p2\">**</ept>、<bpt id=\"p3\">**</bpt>sbyte<ept id=\"p3\">**</ept>、<bpt id=\"p4\">**</bpt>char<ept id=\"p4\">**</ept>、<bpt id=\"p5\">**</bpt>short<ept id=\"p5\">**</ept>、<bpt id=\"p6\">**</bpt>ushort<ept id=\"p6\">**</ept>、<bpt id=\"p7\">**</bpt>int<ept id=\"p7\">**</ept>、<bpt id=\"p8\">**</bpt>uint<ept id=\"p8\">**</ept>、<bpt id=\"p9\">**</bpt>long<ept id=\"p9\">**</ept>、<bpt id=\"p10\">**</bpt>ulong<ept id=\"p10\">**</ept>、<bpt id=\"p11\">**</bpt>float<ept id=\"p11\">**</ept>、<bpt id=\"p12\">**</bpt>double<ept id=\"p12\">**</ept>、<bpt id=\"p13\">**</bpt>decimal<ept id=\"p13\">**</ept>、<bpt id=\"p14\">**</bpt>bool<ept id=\"p14\">**</ept>、<bpt id=\"p15\">**</bpt>Guid<ept id=\"p15\">**</ept>、<bpt id=\"p16\">**</bpt>string<ept id=\"p16\">**</ept>、<bpt id=\"p17\">**</bpt>Uri<ept id=\"p17\">**</ept>、<bpt id=\"p18\">**</bpt>DateTime<ept id=\"p18\">**</ept>、<bpt id=\"p19\">**</bpt>DateTimeOffset<ept id=\"p19\">**</ept> 和 <bpt id=\"p20\">**</bpt>TimeSpan<ept id=\"p20\">**</ept>。以下 .NET 代码显示如何使用上述每种属性类型在 <bpt id=\"p21\">[</bpt>BrokeredMessage<ept id=\"p21\">][]</ept> 对象上设置属性。"
    },
    {
      "content": "以下 Python 代码演示如何读取从服务总线 .NET 客户端收到的消息的应用程序属性。",
      "pos": [
        3882,
        3927
      ]
    },
    {
      "content": "下表将 .NET 属性类型映射到 Python 属性类型。",
      "pos": [
        4087,
        4116
      ]
    },
    {
      "content": ".NET 属性类型",
      "pos": [
        4120,
        4129
      ]
    },
    {
      "content": "Python 属性类型",
      "pos": [
        4132,
        4143
      ]
    },
    {
      "content": "说明",
      "pos": [
        4146,
        4148
      ]
    },
    {
      "content": "byte",
      "pos": [
        4365,
        4369
      ]
    },
    {
      "content": "int",
      "pos": [
        4372,
        4375
      ]
    },
    {
      "content": "-",
      "pos": [
        4378,
        4379
      ]
    },
    {
      "content": "sbyte",
      "pos": [
        4385,
        4390
      ]
    },
    {
      "content": "int",
      "pos": [
        4393,
        4396
      ]
    },
    {
      "content": "-",
      "pos": [
        4399,
        4400
      ]
    },
    {
      "content": "char",
      "pos": [
        4406,
        4410
      ]
    },
    {
      "content": "char",
      "pos": [
        4413,
        4417
      ]
    },
    {
      "content": "Proton-Python 类",
      "pos": [
        4420,
        4435
      ]
    },
    {
      "content": "short",
      "pos": [
        4441,
        4446
      ]
    },
    {
      "content": "int",
      "pos": [
        4449,
        4452
      ]
    },
    {
      "content": "-",
      "pos": [
        4455,
        4456
      ]
    },
    {
      "content": "ushort",
      "pos": [
        4462,
        4468
      ]
    },
    {
      "content": "int",
      "pos": [
        4471,
        4474
      ]
    },
    {
      "content": "-",
      "pos": [
        4477,
        4478
      ]
    },
    {
      "content": "int",
      "pos": [
        4484,
        4487
      ]
    },
    {
      "content": "int",
      "pos": [
        4490,
        4493
      ]
    },
    {
      "content": "-",
      "pos": [
        4496,
        4497
      ]
    },
    {
      "content": "uint",
      "pos": [
        4503,
        4507
      ]
    },
    {
      "content": "int",
      "pos": [
        4510,
        4513
      ]
    },
    {
      "content": "-",
      "pos": [
        4516,
        4517
      ]
    },
    {
      "content": "long",
      "pos": [
        4523,
        4527
      ]
    },
    {
      "content": "int",
      "pos": [
        4530,
        4533
      ]
    },
    {
      "content": "-",
      "pos": [
        4536,
        4537
      ]
    },
    {
      "content": "ulong",
      "pos": [
        4543,
        4548
      ]
    },
    {
      "content": "long",
      "pos": [
        4551,
        4555
      ]
    },
    {
      "content": "Proton-Python 类",
      "pos": [
        4558,
        4573
      ]
    },
    {
      "content": "float",
      "pos": [
        4579,
        4584
      ]
    },
    {
      "content": "float",
      "pos": [
        4587,
        4592
      ]
    },
    {
      "content": "-",
      "pos": [
        4595,
        4596
      ]
    },
    {
      "content": "double",
      "pos": [
        4602,
        4608
      ]
    },
    {
      "content": "float",
      "pos": [
        4611,
        4616
      ]
    },
    {
      "content": "-",
      "pos": [
        4619,
        4620
      ]
    },
    {
      "content": "decimal",
      "pos": [
        4626,
        4633
      ]
    },
    {
      "content": "String",
      "pos": [
        4636,
        4642
      ]
    },
    {
      "content": "Proton 目前不支持 Decimal。",
      "pos": [
        4645,
        4666
      ]
    },
    {
      "content": "bool",
      "pos": [
        4671,
        4675
      ]
    },
    {
      "content": "bool",
      "pos": [
        4678,
        4682
      ]
    },
    {
      "content": "-",
      "pos": [
        4685,
        4686
      ]
    },
    {
      "content": "Guid",
      "pos": [
        4692,
        4696
      ]
    },
    {
      "content": "uuid",
      "pos": [
        4699,
        4703
      ]
    },
    {
      "content": "Proton-Python 类",
      "pos": [
        4706,
        4721
      ]
    },
    {
      "content": "string",
      "pos": [
        4727,
        4733
      ]
    },
    {
      "content": "string",
      "pos": [
        4736,
        4742
      ]
    },
    {
      "content": "-",
      "pos": [
        4745,
        4746
      ]
    },
    {
      "content": "DateTime",
      "pos": [
        4752,
        4760
      ]
    },
    {
      "content": "timestamp",
      "pos": [
        4763,
        4772
      ]
    },
    {
      "content": "Proton-Python 类",
      "pos": [
        4775,
        4790
      ]
    },
    {
      "content": "DateTimeOffset",
      "pos": [
        4796,
        4810
      ]
    },
    {
      "content": "DescribedType",
      "pos": [
        4813,
        4826
      ]
    },
    {
      "content": "映射到 AMQP 类型的 DateTimeOffset.UtcTicks：",
      "pos": [
        4828,
        4865
      ]
    },
    {
      "content": "TimeSpan",
      "pos": [
        4990,
        4998
      ]
    },
    {
      "content": "DescribedType",
      "pos": [
        5001,
        5014
      ]
    },
    {
      "content": "映射到 AMQP 类型的 Timespan.Ticks：",
      "pos": [
        5017,
        5045
      ]
    },
    {
      "content": "Uri",
      "pos": [
        5156,
        5159
      ]
    },
    {
      "content": "DescribedType",
      "pos": [
        5162,
        5175
      ]
    },
    {
      "content": "映射到 AMQP 类型的 Uri.AbsoluteUri：",
      "pos": [
        5178,
        5207
      ]
    },
    {
      "content": "标准属性",
      "pos": [
        5312,
        5316
      ]
    },
    {
      "pos": [
        5318,
        5378
      ],
      "content": "下表显示了 Proton-Python 标准消息属性与 <bpt id=\"p1\">[</bpt>BrokeredMessage<ept id=\"p1\">][]</ept> 标准消息属性之间的映射。"
    },
    {
      "content": "Proton-Python 到服务总线 .NET API",
      "pos": [
        5385,
        5413
      ]
    },
    {
      "content": "Proton-Python",
      "pos": [
        5417,
        5430
      ]
    },
    {
      "content": "服务总线 .NET",
      "pos": [
        5433,
        5442
      ]
    },
    {
      "content": "说明",
      "pos": [
        5445,
        5447
      ]
    },
    {
      "content": "durable",
      "pos": [
        5564,
        5571
      ]
    },
    {
      "content": "不适用",
      "pos": [
        5574,
        5577
      ]
    },
    {
      "content": "服务总线仅支持持久消息。",
      "pos": [
        5580,
        5592
      ]
    },
    {
      "content": "priority",
      "pos": [
        5597,
        5605
      ]
    },
    {
      "content": "不适用",
      "pos": [
        5608,
        5611
      ]
    },
    {
      "content": "服务总线仅支持单一消息优先级。",
      "pos": [
        5614,
        5629
      ]
    },
    {
      "content": "Ttl",
      "pos": [
        5634,
        5637
      ]
    },
    {
      "content": "Message.TimeToLive",
      "pos": [
        5640,
        5658
      ]
    },
    {
      "content": "转换，Proton-Python TTL 以毫秒为单位定义。",
      "pos": [
        5661,
        5691
      ]
    },
    {
      "content": "first_acquirer",
      "pos": [
        5696,
        5710
      ]
    },
    {
      "content": "不适用",
      "pos": [
        5713,
        5716
      ]
    },
    {
      "content": "-",
      "pos": [
        5719,
        5720
      ]
    },
    {
      "content": "delivery_count",
      "pos": [
        5726,
        5740
      ]
    },
    {
      "content": "不适用",
      "pos": [
        5743,
        5746
      ]
    },
    {
      "content": "-",
      "pos": [
        5749,
        5750
      ]
    },
    {
      "content": "Id",
      "pos": [
        5756,
        5758
      ]
    },
    {
      "content": "Message.MessageID",
      "pos": [
        5761,
        5778
      ]
    },
    {
      "content": "-",
      "pos": [
        5781,
        5782
      ]
    },
    {
      "content": "user_id",
      "pos": [
        5788,
        5795
      ]
    },
    {
      "content": "不适用",
      "pos": [
        5798,
        5801
      ]
    },
    {
      "content": "-",
      "pos": [
        5804,
        5805
      ]
    },
    {
      "content": "address",
      "pos": [
        5811,
        5818
      ]
    },
    {
      "content": "Message.To",
      "pos": [
        5821,
        5831
      ]
    },
    {
      "content": "-",
      "pos": [
        5834,
        5835
      ]
    },
    {
      "content": "subject",
      "pos": [
        5841,
        5848
      ]
    },
    {
      "content": "Message.Label",
      "pos": [
        5851,
        5864
      ]
    },
    {
      "content": "-",
      "pos": [
        5867,
        5868
      ]
    },
    {
      "content": "reply_to",
      "pos": [
        5873,
        5881
      ]
    },
    {
      "content": "Message.ReplyTo",
      "pos": [
        5884,
        5899
      ]
    },
    {
      "content": "-",
      "pos": [
        5902,
        5903
      ]
    },
    {
      "content": "correlation_id",
      "pos": [
        5909,
        5923
      ]
    },
    {
      "content": "Message.CorrelationID",
      "pos": [
        5926,
        5947
      ]
    },
    {
      "content": "-",
      "pos": [
        5950,
        5951
      ]
    },
    {
      "content": "content_type",
      "pos": [
        5957,
        5969
      ]
    },
    {
      "content": "Message.ContentType",
      "pos": [
        5972,
        5991
      ]
    },
    {
      "content": "-",
      "pos": [
        5994,
        5995
      ]
    },
    {
      "content": "content_encoding",
      "pos": [
        5999,
        6015
      ]
    },
    {
      "content": "不适用",
      "pos": [
        6018,
        6021
      ]
    },
    {
      "content": "-",
      "pos": [
        6024,
        6025
      ]
    },
    {
      "content": "expiry\\_time",
      "pos": [
        6030,
        6042
      ]
    },
    {
      "content": "不适用",
      "pos": [
        6045,
        6048
      ]
    },
    {
      "content": "-",
      "pos": [
        6051,
        6052
      ]
    },
    {
      "content": "creation_time",
      "pos": [
        6058,
        6071
      ]
    },
    {
      "content": "不适用",
      "pos": [
        6074,
        6077
      ]
    },
    {
      "content": "-",
      "pos": [
        6080,
        6081
      ]
    },
    {
      "content": "group_id",
      "pos": [
        6087,
        6095
      ]
    },
    {
      "content": "Message.SessionId",
      "pos": [
        6098,
        6115
      ]
    },
    {
      "content": "-",
      "pos": [
        6118,
        6119
      ]
    },
    {
      "content": "group_sequence",
      "pos": [
        6125,
        6139
      ]
    },
    {
      "content": "不适用",
      "pos": [
        6142,
        6145
      ]
    },
    {
      "content": "-",
      "pos": [
        6148,
        6149
      ]
    },
    {
      "content": "reply_to_group_id",
      "pos": [
        6155,
        6172
      ]
    },
    {
      "content": "Message.ReplyToSessionId",
      "pos": [
        6175,
        6199
      ]
    },
    {
      "content": "-",
      "pos": [
        6202,
        6203
      ]
    },
    {
      "content": "format",
      "pos": [
        6209,
        6215
      ]
    },
    {
      "content": "不适用",
      "pos": [
        6218,
        6221
      ]
    },
    {
      "content": "-",
      "pos": [
        6224,
        6225
      ]
    },
    {
      "content": "服务总线 .NET",
      "pos": [
        6231,
        6240
      ]
    },
    {
      "content": "Proton",
      "pos": [
        6243,
        6249
      ]
    },
    {
      "content": "说明",
      "pos": [
        6252,
        6254
      ]
    },
    {
      "content": "ContentType",
      "pos": [
        6378,
        6389
      ]
    },
    {
      "content": "Message.content_type",
      "pos": [
        6392,
        6412
      ]
    },
    {
      "content": "-",
      "pos": [
        6415,
        6416
      ]
    },
    {
      "content": "CorrelationId",
      "pos": [
        6422,
        6435
      ]
    },
    {
      "content": "Message.correlation_id",
      "pos": [
        6438,
        6460
      ]
    },
    {
      "content": "-",
      "pos": [
        6463,
        6464
      ]
    },
    {
      "content": "EnqueuedTimeUtc",
      "pos": [
        6470,
        6485
      ]
    },
    {
      "content": "不适用",
      "pos": [
        6488,
        6491
      ]
    },
    {
      "content": "-",
      "pos": [
        6494,
        6495
      ]
    },
    {
      "content": "Label",
      "pos": [
        6501,
        6506
      ]
    },
    {
      "content": "Message.subject",
      "pos": [
        6509,
        6524
      ]
    },
    {
      "content": "-",
      "pos": [
        6527,
        6528
      ]
    },
    {
      "content": "MessageId",
      "pos": [
        6534,
        6543
      ]
    },
    {
      "content": "Message.id",
      "pos": [
        6546,
        6556
      ]
    },
    {
      "content": "-",
      "pos": [
        6559,
        6560
      ]
    },
    {
      "content": "ReplyTo",
      "pos": [
        6566,
        6573
      ]
    },
    {
      "content": "Message.reply_to",
      "pos": [
        6576,
        6592
      ]
    },
    {
      "content": "-",
      "pos": [
        6595,
        6596
      ]
    },
    {
      "content": "ReplyToSessionId",
      "pos": [
        6602,
        6618
      ]
    },
    {
      "content": "Message.reply_to_group_id",
      "pos": [
        6621,
        6646
      ]
    },
    {
      "content": "-",
      "pos": [
        6649,
        6650
      ]
    },
    {
      "content": "ScheduledEnqueueTimeUtc",
      "pos": [
        6656,
        6679
      ]
    },
    {
      "content": "不适用",
      "pos": [
        6682,
        6685
      ]
    },
    {
      "content": "-",
      "pos": [
        6688,
        6689
      ]
    },
    {
      "content": "SessionId",
      "pos": [
        6695,
        6704
      ]
    },
    {
      "content": "Message.group_id",
      "pos": [
        6707,
        6723
      ]
    },
    {
      "content": "-",
      "pos": [
        6726,
        6727
      ]
    },
    {
      "content": "TimeToLive",
      "pos": [
        6733,
        6743
      ]
    },
    {
      "content": "Message.ttl",
      "pos": [
        6746,
        6757
      ]
    },
    {
      "content": "转换，Proton-Python TTL 以毫秒为单位定义。",
      "pos": [
        6760,
        6790
      ]
    },
    {
      "content": "To",
      "pos": [
        6795,
        6797
      ]
    },
    {
      "content": "Message.address",
      "pos": [
        6800,
        6815
      ]
    },
    {
      "content": "-",
      "pos": [
        6818,
        6819
      ]
    },
    {
      "content": "后续步骤",
      "pos": [
        6826,
        6830
      ]
    },
    {
      "content": "准备好了解详细信息？ 请访问以下链接：",
      "pos": [
        6832,
        6851
      ]
    },
    {
      "content": "服务总线 AMQP 概述",
      "pos": [
        6856,
        6868
      ]
    },
    {
      "content": "适用于 Windows Server 的服务总线中的 AMQP",
      "pos": [
        6873,
        6904
      ]
    }
  ],
  "content": "<properties \n   pageTitle=\"服务总线 和 Python 与 AMQP 1.0 | Azure\"\n   description=\"使用 AMQP 通过 Python 使用服务总线。\"\n   services=\"service-bus\"\n   documentationCenter=\"na\"\n   authors=\"sethmanheim\"\n   manager=\"timlt\"\n   editor=\"tysonn\" /> \n<tags \n   ms.service=\"service-bus\"\n   ms.date=\"10/07/2015\"\n   wacn.date=\"11/27/2015\" />\n\n# 使用 AMQP 1.0 通过 Python 使用服务总线\n\n[AZURE.INCLUDE [service-bus-selector-amqp](../includes/service-bus-selector-amqp.md)]\n\nProton-Python 是绑定到 Proton-C 的 Python 语言；也就是说，Proton-Python 是作为 C 中实现的引擎周围的包装器实现的。\n\n## 下载 Proton 客户端库\n\n你可以从 [http://qpid.apache.org/download.html](http://qpid.apache.org/download.html) 下载 Proton-C 及其关联的绑定（包括 Python）。此下载采用源代码格式。若要生成代码，请按照已下载的程序包中包含的说明操作。\n\n请注意，在撰写本文时，Proton-C 中的 SSL 支持仅适用于 Linux 操作系统。由于 Azure 服务总线需要使用 SSL，目前，Proton-C（及语言绑定）只能用于从 Linux 访问服务总线。对 Windows 上的 SSL 启用 Proton-C 的开发工作正在进行中，因此请经常返回查看是否有更新。\n\n## 通过 Python 使用服务总线队列、主题和订阅\n\n以下代码演示如何从服务总线消息实体发送和接收消息。\n\n### 使用 Proton-Python 发送消息\n\n以下代码演示如何向服务总线消息实体发送消息。\n\n```\nmessenger = Messenger()\nmessage = Message()\nmessage.address = \"amqps://[username]:[password]@[namespace].servicebus.chinacloudapi.cn/[entity]\"\n\nmessage.body = u\"This is a text string\"\nmessenger.put(message)\nmessenger.send()\n```\n\n### 使用 Proton-Python 接收消息\n\n以下代码演示如何从服务总线消息实体接收消息。\n\n```\nmessenger = Messenger()\naddress = \"amqps://[username]:[password]@[namespace].servicebus.chinacloudapi.cn/[entity]\"\nmessenger.subscribe(address)\n\nmessenger.start()\nmessenger.recv(1)\nmessage = Message()\nif messenger.incoming:\n      messenger.get(message)\nmessenger.stop()\n```\n\n## 在 .NET 和 Proton-Python 之间进行消息传递\n\n### 应用程序属性\n\n#### Proton-Python 到服务总线 .NET API\n\nProton-Python 消息支持以下类型的应用程序属性：**int**、**long**、**float**、**uuid**、**bool**、**string**。以下 Python 代码显示如何使用上述每种属性类型在消息上设置属性。\n\n```\nmessage.properties[u\"TestString\"] = u\"This is a string\"    \nmessage.properties[u\"TestInt\"] = 1\nmessage.properties[u\"TestLong\"] = 1000L\nmessage.properties[u\"TestFloat\"] = 1.5    \nmessage.properties[u\"TestGuid\"] = uuid.uuid1()    \n```\n\n在服务总线 .NET API 中，在 [BrokeredMessage][] 的 **Properties** 集合中携带消息应用程序属性。以下代码演示如何读取从 Python 客户端收到的消息的应用程序属性。\n\n```\nif (message.Properties.Keys.Count > 0)\n{\n  foreach (string name in message.Properties.Keys)\n  {\n    Object value = message.Properties[name];\n    Console.WriteLine(name + \": \" + value + \" (\" + value.GetType() + \")\" );\n  }\n  Console.WriteLine();\n}\n```\n\n下表将 Python 属性类型映射到 .NET 属性类型。\n\n| Python 属性类型 | .NET 属性类型 |\n|----------------------|--------------------|\n| int | int |\n| float | double |\n| long | int64 |\n| uuid | guid |\n| bool | bool |\n| 字符串 | 字符串 |\n\n#### 服务总线 .NET API 到 Proton-Python\n\n[BrokeredMessage][] 类型支持以下类型的应用程序属性：**byte**、**sbyte**、**char**、**short**、**ushort**、**int**、**uint**、**long**、**ulong**、**float**、**double**、**decimal**、**bool**、**Guid**、**string**、**Uri**、**DateTime**、**DateTimeOffset** 和 **TimeSpan**。以下 .NET 代码显示如何使用上述每种属性类型在 [BrokeredMessage][] 对象上设置属性。\n\n```\nmessage.Properties[\"TestByte\"] = (byte)128;\nmessage.Properties[\"TestSbyte\"] = (sbyte)-22;\nmessage.Properties[\"TestChar\"] = (char) 'X';\nmessage.Properties[\"TestShort\"] = (short)-12345;\nmessage.Properties[\"TestUshort\"] = (ushort)12345;\nmessage.Properties[\"TestInt\"] = (int)-100;\nmessage.Properties[\"TestUint\"] = (uint)100;\nmessage.Properties[\"TestLong\"] = (long)-12345;\nmessage.Properties[\"TestUlong\"] = (ulong)12345;\nmessage.Properties[\"TestFloat\"] = (float)3.14159;\nmessage.Properties[\"TestDouble\"] = (double)3.14159;\nmessage.Properties[\"TestDecimal\"] = (decimal)3.14159;\nmessage.Properties[\"TestBoolean\"] = true;\nmessage.Properties[\"TestGuid\"] = Guid.NewGuid();\nmessage.Properties[\"TestString\"] = \"Service Bus\";\nmessage.Properties[\"TestUri\"] = new Uri(\"http://www.bing.com\");\nmessage.Properties[\"TestDateTime\"] = DateTime.Now;\nmessage.Properties[\"TestDateTimeOffSet\"] = DateTimeOffset.Now;\nmessage.Properties[\"TestTimeSpan\"] = TimeSpan.FromMinutes(60);\nmessage.Properties[\"TestTimeSpan\"] = TimeSpan.FromMinutes(60);\n```\n\n以下 Python 代码演示如何读取从服务总线 .NET 客户端收到的消息的应用程序属性。\n\n```\nif message.properties != None:\n   for k,v in message.properties.items():         \n         print \"--   %s : %s (%s)\" % (k, str(v), type(v))         \n```\n\n下表将 .NET 属性类型映射到 Python 属性类型。\n\n| .NET 属性类型 | Python 属性类型 | 说明 |\n|--------------------|----------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| byte | int | - | \n| sbyte | int | - | \n| char | char | Proton-Python 类 | \n| short | int | - | \n| ushort | int | - | \n| int | int | - | \n| uint | int | - | \n| long | int | - | \n| ulong | long | Proton-Python 类 | \n| float | float | - | \n| double | float | - | \n| decimal | String | Proton 目前不支持 Decimal。| \n| bool | bool | - | \n| Guid | uuid | Proton-Python 类 | \n| string | string | - | \n| DateTime | timestamp | Proton-Python 类 | \n| DateTimeOffset | DescribedType |映射到 AMQP 类型的 DateTimeOffset.UtcTicks：<type name=”datetime-offset” class=restricted source=”long”> <descriptor name=”com.microsoft:datetime-offset” /></type> | \n| TimeSpan | DescribedType | 映射到 AMQP 类型的 Timespan.Ticks：<type name=”timespan” class=restricted source=”long”> <descriptor name=”com.microsoft:timespan” /></type> | \n| Uri | DescribedType | 映射到 AMQP 类型的 Uri.AbsoluteUri：<type name=”uri” class=restricted source=”string”> <descriptor name=”com.microsoft:uri” /></type> |\n\n### 标准属性\n\n下表显示了 Proton-Python 标准消息属性与 [BrokeredMessage][] 标准消息属性之间的映射。\n\n#### Proton-Python 到服务总线 .NET API\n\n| Proton-Python | 服务总线 .NET | 说明 |\n|----------------------|--------------------------|-----------------------------------------------------------|\n| durable | 不适用 | 服务总线仅支持持久消息。 |\n| priority | 不适用 | 服务总线仅支持单一消息优先级。 |\n| Ttl | Message.TimeToLive | 转换，Proton-Python TTL 以毫秒为单位定义。 |\n| first_acquirer | 不适用 | - | \n| delivery_count | 不适用 | - | \n| Id | Message.MessageID | - | \n| user_id | 不适用 | - | \n| address | Message.To | - | \n| subject | Message.Label | - |\n| reply_to | Message.ReplyTo | - | \n| correlation_id | Message.CorrelationID | - | \n| content_type | Message.ContentType | - \n| content_encoding | 不适用 | - | | expiry\\_time | 不适用 | - | \n| creation_time | 不适用 | - | \n| group_id | Message.SessionId | - | \n| group_sequence | 不适用 | - | \n| reply_to_group_id | Message.ReplyToSessionId | - | \n| format | 不适用 | - |\n\n| 服务总线 .NET | Proton | 说明 |\n|-------------------------|------------------------------|-----------------------------------------------------------|\n| ContentType | Message.content_type | - | \n| CorrelationId | Message.correlation_id | - | \n| EnqueuedTimeUtc | 不适用 | - | \n| Label | Message.subject | - | \n| MessageId | Message.id | - | \n| ReplyTo | Message.reply_to | - | \n| ReplyToSessionId | Message.reply_to_group_id | - | \n| ScheduledEnqueueTimeUtc | 不适用 | - | \n| SessionId | Message.group_id | - | \n| TimeToLive | Message.ttl | 转换，Proton-Python TTL 以毫秒为单位定义。| \n| To | Message.address | - |\n\n## 后续步骤\n\n准备好了解详细信息？ 请访问以下链接：\n\n- [服务总线 AMQP 概述]\n- [适用于 Windows Server 的服务总线中的 AMQP]\n\n[BrokeredMessage]: https://msdn.microsoft.com/zh-cn/library/azure/microsoft.servicebus.messaging.brokeredmessage.aspx\n[适用于 Windows Server 的服务总线中的 AMQP]: https://msdn.microsoft.com/zh-cn/library/dn574799.aspx\n\n[服务总线 AMQP 概述]: /documentation/articles/service-bus-amqp-overview\n\n<!---HONumber=82-->"
}