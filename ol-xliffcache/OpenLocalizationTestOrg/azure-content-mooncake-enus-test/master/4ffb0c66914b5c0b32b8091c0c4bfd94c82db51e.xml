{
  "nodes": [
    {
      "content": "Azure CDN FAQ - Azure feature guide",
      "pos": [
        78,
        113
      ]
    },
    {
      "content": "Find answers to common service consulting or inquiries related to Azure CDN",
      "pos": [
        336,
        411
      ]
    },
    {
      "content": "常见问题 - 咨询",
      "pos": [
        598,
        607
      ]
    },
    {
      "content": "[AZURE.SELECTOR]",
      "pos": [
        611,
        627
      ]
    },
    {
      "content": "中文版",
      "pos": [
        631,
        634
      ]
    },
    {
      "content": "English Version",
      "pos": [
        688,
        703
      ]
    },
    {
      "content": "CDN的概念和作用",
      "pos": [
        763,
        772
      ]
    },
    {
      "content": "什么是CNAME",
      "pos": [
        785,
        793
      ]
    },
    {
      "content": "CDN流量和回原流量关系",
      "pos": [
        806,
        818
      ]
    },
    {
      "content": "影响缓存命中率的因素有哪些？",
      "pos": [
        831,
        845
      ]
    },
    {
      "content": "CDN域名创建需要多久？",
      "pos": [
        858,
        870
      ]
    },
    {
      "content": "开通CDN一定要有备案号吗？",
      "pos": [
        883,
        897
      ]
    },
    {
      "content": "二级域名需要备案吗？",
      "pos": [
        910,
        920
      ]
    },
    {
      "content": "备案号失效后，CDN服务还可以用多久？",
      "pos": [
        933,
        952
      ]
    },
    {
      "content": "如果域名有跳转是否可以使用CDN？",
      "pos": [
        966,
        983
      ]
    },
    {
      "content": "Azure CDN支持哪些类型的加速？",
      "pos": [
        996,
        1015
      ]
    },
    {
      "content": "CDN加速类型中的“WEB加速”、“下载加速”、“VOD加速”、“流媒体直播加速”、“HTTPS加速”具体有什么区别？",
      "pos": [
        1029,
        1088
      ]
    },
    {
      "content": "Azure CDN默认的缓存规则是什么？",
      "pos": [
        1102,
        1122
      ]
    },
    {
      "content": "CDN节点上的文件最大缓存时长是多少？",
      "pos": [
        1136,
        1155
      ]
    },
    {
      "content": "CDN节点的缓存规则同步时间和缓存文件同步时间是多久？",
      "pos": [
        1169,
        1196
      ]
    },
    {
      "content": "如何让新提交的URL起到提前缓存的效果？",
      "pos": [
        1210,
        1230
      ]
    },
    {
      "content": "可以给泛域名配置缓存规则吗？",
      "pos": [
        1244,
        1258
      ]
    },
    {
      "content": "自定义域名为泛域名时支持缓存刷新操作吗？",
      "pos": [
        1272,
        1292
      ]
    },
    {
      "content": "加载可以使用泛域名吗？",
      "pos": [
        1306,
        1317
      ]
    },
    {
      "content": "源站地址（回源地址）”和“回源域名（回源host header）”的区别是什么",
      "pos": [
        1331,
        1370
      ]
    },
    {
      "content": "Blob使用CDN加速，是否直接使用blob地址，而不使用自定义域名，是否还需要备案，为什么？",
      "pos": [
        1384,
        1431
      ]
    },
    {
      "content": "是否支持HTTP标头gzip功能？",
      "pos": [
        1445,
        1462
      ]
    },
    {
      "content": "如果有多个订阅，如何在不同的订阅间切换？",
      "pos": [
        1476,
        1496
      ]
    },
    {
      "content": "一个账户内是否对本账户添加的加速域名个数有限制？",
      "pos": [
        1510,
        1534
      ]
    },
    {
      "content": "Azure账号过期，如何将CDN迁到另一个Azure账号？",
      "pos": [
        1548,
        1577
      ]
    },
    {
      "pos": [
        1592,
        1623
      ],
      "content": "<bpt id=\"p1\">**</bpt>CDN的概念和作用<ept id=\"p1\">**</ept><ph id=\"ph1\">&lt;a id=\"step2\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>"
    },
    {
      "content": "CDN 的全称是 Content Delivery Network，即内容分发网络。CDN通过在现有的 Internet 中添加一层新的网络架构，将网站的内容缓存到离用户最近的网络“边缘”，使用户可以就近取得所需的内容，从而提供高带宽、低延迟的用户体验。",
      "pos": [
        1625,
        1752
      ]
    },
    {
      "pos": [
        1758,
        1789
      ],
      "content": "<bpt id=\"p1\">**</bpt>什么是CNAME？<ept id=\"p1\">**</ept><ph id=\"ph1\">&lt;a id=\"step3\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>"
    },
    {
      "content": "CNAME(Canonical Name record)，通常是别名指向。例如，假设用户自定义加速域名为www.abc.com，用户配置完成后网站加速里给出的CDN服务域名为www.abc.com.mschcdn.com。用户需要在域名托管服务商那里将www.abc.com对应的A记录删除，添加域名的CNAME记录为www.abc.com.mschcdn.com。这样，用户访问www.abc.com时会去获取www.abc.com.mschcdn.com解析出的加速节点的IP地址记录。",
      "pos": [
        1791,
        2036
      ]
    },
    {
      "pos": [
        2041,
        2075
      ],
      "content": "<bpt id=\"p1\">**</bpt>CDN流量和回源流量关系<ept id=\"p1\">**</ept><ph id=\"ph1\">&lt;a id=\"step4\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>"
    },
    {
      "content": "CDN流量表示缓存命中",
      "pos": [
        2079,
        2090
      ]
    },
    {
      "content": "回原流量表示MISS部分",
      "pos": [
        2098,
        2110
      ]
    },
    {
      "pos": [
        2116,
        2152
      ],
      "content": "<bpt id=\"p1\">**</bpt>影响缓存命中率的因素有哪些？<ept id=\"p1\">**</ept><ph id=\"ph1\">&lt;a id=\"step5\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>"
    },
    {
      "content": "影响缓存命中率的因素有以下几个：",
      "pos": [
        2154,
        2170
      ]
    },
    {
      "content": "缓存配置，内容预取的设置",
      "pos": [
        2174,
        2186
      ]
    },
    {
      "content": "Http Header导致无法缓存",
      "pos": [
        2190,
        2207
      ]
    },
    {
      "content": "刚添加，缓存的文件还不多",
      "pos": [
        2212,
        2224
      ]
    },
    {
      "content": "源站类型，可缓存的内容少",
      "pos": [
        2229,
        2241
      ]
    },
    {
      "content": "网站访问量低，过期时间短，命中的文件少",
      "pos": [
        2246,
        2265
      ]
    },
    {
      "pos": [
        2271,
        2305
      ],
      "content": "<bpt id=\"p1\">**</bpt>CDN域名创建需要多久？<ept id=\"p1\">**</ept><ph id=\"ph1\">&lt;a id=\"step6\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>"
    },
    {
      "content": "审核所提供的自定义域名和ICP编号是否匹配、有效，这个过程需要最多一个工作日的时间来完成。如果ICP审核通过，CDN服务最多需要 60 分钟时间进行注册以便通过 CDN 网络传播。与此同时，您还需要按照界面上的提示信息配置CNAME映射信息，这样才可以最终通过自定义域名访问CDN缓存内容。",
      "pos": [
        2307,
        2452
      ]
    },
    {
      "pos": [
        2457,
        2493
      ],
      "content": "<bpt id=\"p1\">**</bpt>开通CDN一定要有备案号吗？<ept id=\"p1\">**</ept><ph id=\"ph1\">&lt;a id=\"step7\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>"
    },
    {
      "content": "工信部要求使用CDN一定要有备案号。对于具体的ICP备案要求，仅要求所使用的自定义CDN加速域名有ICP，对源站本身没有要求，同时支持源站在国内和国外。",
      "pos": [
        2496,
        2572
      ]
    },
    {
      "pos": [
        2577,
        2609
      ],
      "content": "<bpt id=\"p1\">**</bpt>二级域名需要备案吗？<ept id=\"p1\">**</ept><ph id=\"ph1\">&lt;a id=\"step8\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>"
    },
    {
      "content": "二级域名不需要备案；如果sample.com已经备案，那么images.sample.com则不需要备案，创建CDN加速节点时仅需提供sample.com的备案号即可。",
      "pos": [
        2611,
        2695
      ]
    },
    {
      "pos": [
        2700,
        2742
      ],
      "content": "<bpt id=\"p1\">**</bpt>备案号失效后，CDN服务还可以用多久？<ept id=\"p1\">**</ept><ph id=\"ph1\">&lt;a id=\"step26\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>"
    },
    {
      "content": "备案号失效后，需要客户自己去通信管理局更新。默认未备案7天，强制回源。如果备案周期过长，同时希望使用CDN服务，可以通过开工单的方式联系我们。",
      "pos": [
        2744,
        2815
      ]
    },
    {
      "pos": [
        2820,
        2859
      ],
      "content": "<bpt id=\"p1\">**</bpt>如果域名有跳转是否可以使用CDN？<ept id=\"p1\">**</ept><ph id=\"ph1\">&lt;a id=\"step9\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>"
    },
    {
      "content": "可以，不过建议给跳转后的域名加速，跳转前的域名加速没有必要。",
      "pos": [
        2861,
        2891
      ]
    },
    {
      "pos": [
        2899,
        2941
      ],
      "content": "<bpt id=\"p1\">**</bpt>Azure CDN支持哪些类型的加速？<ept id=\"p1\">**</ept><ph id=\"ph1\">&lt;a id=\"step11\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>"
    },
    {
      "content": "Azure CDN支持的加速类型包括：Web加速，下载加速，VOD加速，流媒体直播加速和HTTPS加速。",
      "pos": [
        2945,
        2997
      ]
    },
    {
      "content": "现阶段提供的CDN主要是静态加速，包含一部分动态加速技术。比如：通过多线路节点回源，TCP优化等。不支持对PHP，ASP.NET，JSP等动态网页的加速，后续会逐步增加更多对动态页面的加速。",
      "pos": [
        2999,
        3094
      ]
    },
    {
      "pos": [
        3103,
        3185
      ],
      "content": "<bpt id=\"p1\">**</bpt>CDN加速类型中的“WEB加速”、“下载加速”、“VOD加速”、“流媒体直播加速”、“HTTPS加速”具体有什么区别？<ept id=\"p1\">**</ept><ph id=\"ph1\">&lt;a id=\"step12\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>"
    },
    {
      "content": "不同的CDN加速类型对应于不同的使用场景：",
      "pos": [
        3187,
        3208
      ]
    },
    {
      "content": "WEB加速对应于网页等（html, CSS, 图片, JS）比较小的静态文件加速",
      "pos": [
        3213,
        3253
      ]
    },
    {
      "content": "下载加速一般对应于20MB以上的大文件文件分发",
      "pos": [
        3258,
        3281
      ]
    },
    {
      "content": "VOD加速对应于基于HTTP的视频点播加速",
      "pos": [
        3286,
        3307
      ]
    },
    {
      "content": "流媒体直播加速对应于流媒体直播加速",
      "pos": [
        3312,
        3329
      ]
    },
    {
      "content": "HTTPS加速针对对安全性要求比较高的情况，加速文件类型以小文件为主。",
      "pos": [
        3334,
        3369
      ]
    },
    {
      "content": "对应到后端CDN的不同之处主要在于，不同的加速类型由不同的CDN节点设备来支撑，您无需做额外配置。",
      "pos": [
        3371,
        3420
      ]
    },
    {
      "pos": [
        3425,
        3468
      ],
      "content": "<bpt id=\"p1\">**</bpt>Azure CDN默认的缓存规则是什么？<ept id=\"p1\">**</ept><ph id=\"ph1\">&lt;a id=\"step13\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>"
    },
    {
      "content": "Web加速类型，系统默认的缓存规则：",
      "pos": [
        3476,
        3494
      ]
    },
    {
      "content": "对php、aspx、asp、 jsp、 do、 dwr、cgi、 fcgi、action、ashx、axd、json等动态文件不缓存",
      "pos": [
        3502,
        3568
      ]
    },
    {
      "content": "对以shtml、html、htm、js结尾的文件，默认缓存半天（720分钟）",
      "pos": [
        3574,
        3612
      ]
    },
    {
      "content": "其他静态文件默认缓存一天（1440分钟）",
      "pos": [
        3619,
        3639
      ]
    },
    {
      "content": "下载加速类型，系统默认的缓存规则：",
      "pos": [
        3645,
        3662
      ]
    },
    {
      "content": "对php、aspx、asp、jsp、do等动态文件不缓存",
      "pos": [
        3670,
        3698
      ]
    },
    {
      "content": "对7z、apk、 wdf、 cab、 dhp、exe、flv、gz、ipa、iso、mpk、MPQ、pbcv、pxl、qnp、r00、rar、xy、xy2、zip、CAB等文件缓存一个月",
      "pos": [
        3704,
        3797
      ]
    },
    {
      "content": "VOD视频点播加速类型，系统默认的缓存规则：",
      "pos": [
        3803,
        3825
      ]
    },
    {
      "content": "对php、aspx、asp、jsp、do等动态文件不缓存",
      "pos": [
        3833,
        3861
      ]
    },
    {
      "content": "对MP3、wma等缓存1天",
      "pos": [
        3867,
        3880
      ]
    },
    {
      "content": "对mwv、html、htm、shtml、hml、gif、swf、png、bmp、js等缓存1小时",
      "pos": [
        3886,
        3934
      ]
    },
    {
      "content": "对7z、apk、 wdf、 cab、 dhp、exe、flv、gz、ipa、iso、mpk、MPQ、pbcv、pxl、qnp、r00、rar、xy、xy2、zip、CAB等文件缓存一个月",
      "pos": [
        3940,
        4033
      ]
    },
    {
      "content": "流媒体直播加速类型，系统默认的缓存规则：",
      "pos": [
        4039,
        4059
      ]
    },
    {
      "content": "对ts文件缓存2分钟",
      "pos": [
        4067,
        4077
      ]
    },
    {
      "content": "对m3u8 文件缓存2秒钟",
      "pos": [
        4083,
        4096
      ]
    },
    {
      "content": "缓存规则逻辑：",
      "pos": [
        4105,
        4112
      ]
    },
    {
      "content": "如果用户配置了不缓存的规则，优先匹配；然后匹配需要缓存的规则；缓存规则自上而下匹配。",
      "pos": [
        4122,
        4164
      ]
    },
    {
      "content": "如果某个URL在不缓存、缓存规则里都没有匹配上，那么就遵循CDN默认规则。",
      "pos": [
        4172,
        4209
      ]
    },
    {
      "pos": [
        4214,
        4256
      ],
      "content": "<bpt id=\"p1\">**</bpt>CDN节点上的文件最大缓存时长是多少？<ept id=\"p1\">**</ept><ph id=\"ph1\">&lt;a id=\"step23\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>"
    },
    {
      "content": "CDN节点上的文件最大缓存时长，是根据用户的缓存规则设置的，系统对于时长没有限制。",
      "pos": [
        4258,
        4299
      ]
    },
    {
      "pos": [
        4304,
        4354
      ],
      "content": "<bpt id=\"p1\">**</bpt>CDN节点的缓存规则同步时间和缓存文件同步时间是多久？<ept id=\"p1\">**</ept><ph id=\"ph1\">&lt;a id=\"step24\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>"
    },
    {
      "content": "用户的缓存规则设置完成后，大约十分钟可以完成规则下发，CDN节点上的缓存文件同步时间取决于所设置的缓存规则和文件本身的大小；",
      "pos": [
        4356,
        4418
      ]
    },
    {
      "pos": [
        4423,
        4466
      ],
      "content": "<bpt id=\"p1\">**</bpt>如何让新提交的URL起到提前缓存的效果？<ept id=\"p1\">**</ept><ph id=\"ph1\">&lt;a id=\"step27\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>"
    },
    {
      "content": "CDN不会去主动缓存文件，有用户请求那么节点才会去缓存，如果有些节点一直没有用户去请求的话，那么该部分节点是一直没有缓存的。如果想让新提交的URL起到提前缓存的效果，建议使用Azure CDN管理界面的“内容预取”功能。",
      "pos": [
        4468,
        4578
      ]
    },
    {
      "pos": [
        4583,
        4620
      ],
      "content": "<bpt id=\"p1\">**</bpt>可以给泛域名配置缓存规则吗？<ept id=\"p1\">**</ept><ph id=\"ph1\">&lt;a id=\"step14\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>"
    },
    {
      "content": "可以给泛域名配置缓存规则。建了泛域名的话，缓存规则的设定就是该泛域名之下。泛域名主要是针对多个域名配置相同来使用的，简化了创建的步骤。它可以与真正的域名同时创建，真正的域名的配置会优先匹配。例如，如果有个a1.example.com的规则是不一样的，客户可以新建一个 a1.example.com 的endpoint，并在这里面创建缓存规则，这里面的配置会优先于 *.example.com的配置。",
      "pos": [
        4622,
        4821
      ]
    },
    {
      "pos": [
        4826,
        4869
      ],
      "content": "<bpt id=\"p1\">**</bpt>自定义域名为泛域名时支持缓存刷新操作吗？<ept id=\"p1\">**</ept><ph id=\"ph1\">&lt;a id=\"step15\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>"
    },
    {
      "content": "如果自定义域名为泛域名，提交缓存刷新的时候，刷新URL必须指定子域名。比如：自定义域名为*.domain.com，如果要刷新img.domain.com下的内容，则应指定子域名img.domain.com进行缓存刷新操作。",
      "pos": [
        4871,
        4982
      ]
    },
    {
      "pos": [
        4987,
        5022
      ],
      "content": "<bpt id=\"p1\">**</bpt>预加载可以使用泛域名吗？<ept id=\"p1\">**</ept><ph id=\"ph1\">&lt;a id=\"step16\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>"
    },
    {
      "content": "预加载必须是子域名，并且是能够正常访问的URL（状态码是200的）。",
      "pos": [
        5024,
        5058
      ]
    },
    {
      "pos": [
        5068,
        5132
      ],
      "content": "<bpt id=\"p1\">**</bpt>“源站地址（回源地址）”和“回源域名（回源host header）”的区别是什么？<ept id=\"p1\">**</ept><ph id=\"ph1\">&lt;a id=\"step17\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>"
    },
    {
      "content": "回源地址表示源站实际可以被访问到的地址，可以是IP也可以是域名。如果是域名，CDN在回源是会对该域名进行地址解析，然后用解析出来的IP再进行访问。",
      "pos": [
        5136,
        5209
      ]
    },
    {
      "content": "回源域名表示CDN回源时，HTTP请求头（request header）中的Host字段值。这个字段值一般是域名形式的字符串，被源站用来识别是否与源站服务器上配置的域名相同。",
      "pos": [
        5211,
        5298
      ]
    },
    {
      "pos": [
        5304,
        5374
      ],
      "content": "<bpt id=\"p1\">**</bpt>Blob使用CDN加速，是否直接使用blob地址，而不使用自定义域名，是否还需要备案，为什么？<ept id=\"p1\">**</ept><ph id=\"ph1\">&lt;a id=\"step20\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>"
    },
    {
      "content": "CDN（内容分发网络）说白了就是一组网络内容缓存节点，和客户的源站不是等价的。缓存节点上，只包含用户设置需要缓存的内容，且有可能会过期。",
      "pos": [
        5375,
        5443
      ]
    },
    {
      "content": "自定义域名是用来被CNAME的，通过自定义域名经过CDN访问源网站内容时，源站缓存命中则直接返回，否则可能回源。这是CDN的原理。",
      "pos": [
        5445,
        5510
      ]
    },
    {
      "content": "假设，自定义域名和原始域名一样，会造成：",
      "pos": [
        5512,
        5532
      ]
    },
    {
      "content": "回源失败 – 因为回源的时候可能通过DNS重新访问到加速节点而非源站；",
      "pos": [
        5537,
        5572
      ]
    },
    {
      "content": "访问失败 – 源站部分内容并不在加速节点。",
      "pos": [
        5576,
        5597
      ]
    },
    {
      "content": "法律规定自定义域名是ICP备案的，对源站没有要求。但是如果自定义域名本身的二级域名已经备案，则不需要再备案。",
      "pos": [
        5599,
        5653
      ]
    },
    {
      "pos": [
        5658,
        5698
      ],
      "content": "<bpt id=\"p1\">**</bpt>是否支持HTTP标头gzip功能？<ept id=\"p1\">**</ept><ph id=\"ph1\">&lt;a id=\"step25\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>"
    },
    {
      "content": "Azure CDN支持HTTP标头的gzip功能，需要客户提交工单开通该功能。提交工单时请提供加速域名，源站域名，以及需要加速的文件类型。",
      "pos": [
        5700,
        5769
      ]
    },
    {
      "pos": [
        5774,
        5817
      ],
      "content": "<bpt id=\"p1\">**</bpt>如果有多个订阅，如何在不同的订阅间切换？<ept id=\"p1\">**</ept><ph id=\"ph1\">&lt;a id=\"step21\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>"
    },
    {
      "content": "如果您有多个订阅，如图所示，可以点击管理门户网站右上角订阅ID处的下拉三角，选择恰当的订阅ID。",
      "pos": [
        5822,
        5870
      ]
    },
    {
      "content": "FAQ",
      "pos": [
        5878,
        5881
      ]
    },
    {
      "pos": [
        5912,
        5964
      ],
      "content": "<bpt id=\"p1\">**</bpt>Azure账号过期，如何将CDN迁到另一个Azure账号？<ept id=\"p1\">**</ept><ph id=\"ph1\">&lt;a id=\"step22\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>"
    },
    {
      "content": "目前在订阅号之间的域名自动迁移还不支持。客户需要手工迁移。先从过期的订阅删除已有域名，然后在新的订阅中重新创建，并且会对域名重新进行审核。",
      "pos": [
        5966,
        6035
      ]
    },
    {
      "pos": [
        6043,
        6090
      ],
      "content": "<bpt id=\"p1\">**</bpt>一个账户内是否对本账户添加的加速域名个数有限制？<ept id=\"p1\">**</ept><ph id=\"ph1\">&lt;a id=\"step10\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>"
    },
    {
      "content": "Azure CDN对每个账户的加速域名个数没有做限制。",
      "pos": [
        6092,
        6119
      ]
    }
  ],
  "content": "<properties linkid=\"dev-net-common-tasks-cdn\" urlDisplayName=\"CDN\" pageTitle=\"Azure CDN FAQ - Azure feature guide\" metaKeywords=\"Azure CDN, Azure CDN, Azure blobs, Azure caching, Azure add-ons, CDN FAQ, CDN常见问题, 回源流量, ICP备案号, CDN默认缓存规则, 回源域名, 订阅, CNAME, 下载加速, Web加速, 网站加速, 流媒体直播加速, VOD加速, 视频点播加速, CDN价格, CDN收费, 技术文档, 帮助文档\" description=\"Find answers to common service consulting or inquiries related to Azure CDN\" metaCanonical=\"\" services=\"\" documentationCenter=\".NET\" title=\"\" authors=\"\" solutions=\"\" manager=\"\" editor=\"\" />\n<tags ms.service=\"cdn\"\n    ms.date=\"\"\n    wacn.date=\"2/23/2016\"\n    />\n#常见问题 - 咨询\n\n> [AZURE.SELECTOR]\n- [中文版](/documentation/articles/cdn-faq-service-inquiry)\n- [English Version](/documentation/articles/cdn-enus-faq-service-inquiry)\n\n+ [CDN的概念和作用](#step2)\n+ [什么是CNAME](#step3)\n+ [CDN流量和回原流量关系](#step4)\n+ [影响缓存命中率的因素有哪些？](#step5)\n+ [CDN域名创建需要多久？](#step6)\n+ [开通CDN一定要有备案号吗？](#step7)\n+ [二级域名需要备案吗？](#step8)\n+ [备案号失效后，CDN服务还可以用多久？](#step26)\n+ [如果域名有跳转是否可以使用CDN？](#step9)\n+ [Azure CDN支持哪些类型的加速？](#step11)\n+ [CDN加速类型中的“WEB加速”、“下载加速”、“VOD加速”、“流媒体直播加速”、“HTTPS加速”具体有什么区别？](#step12)\n+ [Azure CDN默认的缓存规则是什么？](#step13)\n+ [CDN节点上的文件最大缓存时长是多少？](#step23)\n+ [CDN节点的缓存规则同步时间和缓存文件同步时间是多久？](#step24)\n+ [如何让新提交的URL起到提前缓存的效果？](#step27)\n+ [可以给泛域名配置缓存规则吗？](#step14)\n+ [自定义域名为泛域名时支持缓存刷新操作吗？](#step15)\n+ [加载可以使用泛域名吗？](#step16)\n+ [源站地址（回源地址）”和“回源域名（回源host header）”的区别是什么](#step17)\n+ [Blob使用CDN加速，是否直接使用blob地址，而不使用自定义域名，是否还需要备案，为什么？](#step20)\n+ [是否支持HTTP标头gzip功能？](#step25)\n+ [如果有多个订阅，如何在不同的订阅间切换？](#step21)\n+ [一个账户内是否对本账户添加的加速域名个数有限制？](#step10)\n+ [Azure账号过期，如何将CDN迁到另一个Azure账号？](#step22)\n\n## **CDN的概念和作用**<a id=\"step2\"></a>\n\nCDN 的全称是 Content Delivery Network，即内容分发网络。CDN通过在现有的 Internet 中添加一层新的网络架构，将网站的内容缓存到离用户最近的网络“边缘”，使用户可以就近取得所需的内容，从而提供高带宽、低延迟的用户体验。 \n\n## **什么是CNAME？**<a id=\"step3\"></a>\n\nCNAME(Canonical Name record)，通常是别名指向。例如，假设用户自定义加速域名为www.abc.com，用户配置完成后网站加速里给出的CDN服务域名为www.abc.com.mschcdn.com。用户需要在域名托管服务商那里将www.abc.com对应的A记录删除，添加域名的CNAME记录为www.abc.com.mschcdn.com。这样，用户访问www.abc.com时会去获取www.abc.com.mschcdn.com解析出的加速节点的IP地址记录。\n\n## **CDN流量和回源流量关系**<a id=\"step4\"></a>\n\n- CDN流量表示缓存命中\n    \n- 回原流量表示MISS部分 \n\n## **影响缓存命中率的因素有哪些？**<a id=\"step5\"></a>\n\n影响缓存命中率的因素有以下几个：\n\n- 缓存配置，内容预取的设置\n\n- Http Header导致无法缓存 \n\n- 刚添加，缓存的文件还不多 \n\n- 源站类型，可缓存的内容少 \n\n- 网站访问量低，过期时间短，命中的文件少 \n\n## **CDN域名创建需要多久？**<a id=\"step6\"></a>\n\n审核所提供的自定义域名和ICP编号是否匹配、有效，这个过程需要最多一个工作日的时间来完成。如果ICP审核通过，CDN服务最多需要 60 分钟时间进行注册以便通过 CDN 网络传播。与此同时，您还需要按照界面上的提示信息配置CNAME映射信息，这样才可以最终通过自定义域名访问CDN缓存内容。\n\n## **开通CDN一定要有备案号吗？**<a id=\"step7\"></a>\n \n工信部要求使用CDN一定要有备案号。对于具体的ICP备案要求，仅要求所使用的自定义CDN加速域名有ICP，对源站本身没有要求，同时支持源站在国内和国外。\n\n## **二级域名需要备案吗？**<a id=\"step8\"></a>\n\n二级域名不需要备案；如果sample.com已经备案，那么images.sample.com则不需要备案，创建CDN加速节点时仅需提供sample.com的备案号即可。\n\n## **备案号失效后，CDN服务还可以用多久？**<a id=\"step26\"></a>\n\n备案号失效后，需要客户自己去通信管理局更新。默认未备案7天，强制回源。如果备案周期过长，同时希望使用CDN服务，可以通过开工单的方式联系我们。\n\n## **如果域名有跳转是否可以使用CDN？**<a id=\"step9\"></a>\n\n可以，不过建议给跳转后的域名加速，跳转前的域名加速没有必要。\n   \n## **Azure CDN支持哪些类型的加速？**<a id=\"step11\"></a>\n  \nAzure CDN支持的加速类型包括：Web加速，下载加速，VOD加速，流媒体直播加速和HTTPS加速。\n\n现阶段提供的CDN主要是静态加速，包含一部分动态加速技术。比如：通过多线路节点回源，TCP优化等。不支持对PHP，ASP.NET，JSP等动态网页的加速，后续会逐步增加更多对动态页面的加速。\n    \n## **CDN加速类型中的“WEB加速”、“下载加速”、“VOD加速”、“流媒体直播加速”、“HTTPS加速”具体有什么区别？**<a id=\"step12\"></a>\n\n不同的CDN加速类型对应于不同的使用场景：\n\n1. WEB加速对应于网页等（html, CSS, 图片, JS）比较小的静态文件加速\n\n2. 下载加速一般对应于20MB以上的大文件文件分发\n\n3. VOD加速对应于基于HTTP的视频点播加速\n\n4. 流媒体直播加速对应于流媒体直播加速\n\n5. HTTPS加速针对对安全性要求比较高的情况，加速文件类型以小文件为主。\n\n对应到后端CDN的不同之处主要在于，不同的加速类型由不同的CDN节点设备来支撑，您无需做额外配置。\n\n## **Azure CDN默认的缓存规则是什么？**<a id=\"step13\"></a>  \n\n- **Web加速类型，系统默认的缓存规则：**\n  1. 对php、aspx、asp、 jsp、 do、 dwr、cgi、 fcgi、action、ashx、axd、json等动态文件不缓存\n  2. 对以shtml、html、htm、js结尾的文件，默认缓存半天（720分钟） \n  3. 其他静态文件默认缓存一天（1440分钟）\n\n- **下载加速类型，系统默认的缓存规则：**\n  1. 对php、aspx、asp、jsp、do等动态文件不缓存\n  2. 对7z、apk、 wdf、 cab、 dhp、exe、flv、gz、ipa、iso、mpk、MPQ、pbcv、pxl、qnp、r00、rar、xy、xy2、zip、CAB等文件缓存一个月\n\n- **VOD视频点播加速类型，系统默认的缓存规则：**\n  1. 对php、aspx、asp、jsp、do等动态文件不缓存\n  2. 对MP3、wma等缓存1天\n  3. 对mwv、html、htm、shtml、hml、gif、swf、png、bmp、js等缓存1小时\n  4. 对7z、apk、 wdf、 cab、 dhp、exe、flv、gz、ipa、iso、mpk、MPQ、pbcv、pxl、qnp、r00、rar、xy、xy2、zip、CAB等文件缓存一个月\n\n- **流媒体直播加速类型，系统默认的缓存规则：**\n  1. 对ts文件缓存2分钟\n  2. 对m3u8 文件缓存2秒钟 \n    \n**缓存规则逻辑：**\n\n   1. 如果用户配置了不缓存的规则，优先匹配；然后匹配需要缓存的规则；缓存规则自上而下匹配。\n\n   2. 如果某个URL在不缓存、缓存规则里都没有匹配上，那么就遵循CDN默认规则。\n\n## **CDN节点上的文件最大缓存时长是多少？**<a id=\"step23\"></a>\n\nCDN节点上的文件最大缓存时长，是根据用户的缓存规则设置的，系统对于时长没有限制。\n\n## **CDN节点的缓存规则同步时间和缓存文件同步时间是多久？**<a id=\"step24\"></a>\n\n用户的缓存规则设置完成后，大约十分钟可以完成规则下发，CDN节点上的缓存文件同步时间取决于所设置的缓存规则和文件本身的大小；\n\n## **如何让新提交的URL起到提前缓存的效果？**<a id=\"step27\"></a>\n\nCDN不会去主动缓存文件，有用户请求那么节点才会去缓存，如果有些节点一直没有用户去请求的话，那么该部分节点是一直没有缓存的。如果想让新提交的URL起到提前缓存的效果，建议使用Azure CDN管理界面的“内容预取”功能。\n\n## **可以给泛域名配置缓存规则吗？**<a id=\"step14\"></a>\n\n可以给泛域名配置缓存规则。建了泛域名的话，缓存规则的设定就是该泛域名之下。泛域名主要是针对多个域名配置相同来使用的，简化了创建的步骤。它可以与真正的域名同时创建，真正的域名的配置会优先匹配。例如，如果有个a1.example.com的规则是不一样的，客户可以新建一个 a1.example.com 的endpoint，并在这里面创建缓存规则，这里面的配置会优先于 *.example.com的配置。\n\n## **自定义域名为泛域名时支持缓存刷新操作吗？**<a id=\"step15\"></a>\n\n如果自定义域名为泛域名，提交缓存刷新的时候，刷新URL必须指定子域名。比如：自定义域名为*.domain.com，如果要刷新img.domain.com下的内容，则应指定子域名img.domain.com进行缓存刷新操作。\n\n## **预加载可以使用泛域名吗？**<a id=\"step16\"></a>\n\n预加载必须是子域名，并且是能够正常访问的URL（状态码是200的）。\n     \n## **“源站地址（回源地址）”和“回源域名（回源host header）”的区别是什么？**<a id=\"step17\"></a>  \n\n回源地址表示源站实际可以被访问到的地址，可以是IP也可以是域名。如果是域名，CDN在回源是会对该域名进行地址解析，然后用解析出来的IP再进行访问。\n\n回源域名表示CDN回源时，HTTP请求头（request header）中的Host字段值。这个字段值一般是域名形式的字符串，被源站用来识别是否与源站服务器上配置的域名相同。\n\n\n## **Blob使用CDN加速，是否直接使用blob地址，而不使用自定义域名，是否还需要备案，为什么？**<a id=\"step20\"></a>\nCDN（内容分发网络）说白了就是一组网络内容缓存节点，和客户的源站不是等价的。缓存节点上，只包含用户设置需要缓存的内容，且有可能会过期。\n\n自定义域名是用来被CNAME的，通过自定义域名经过CDN访问源网站内容时，源站缓存命中则直接返回，否则可能回源。这是CDN的原理。\n\n假设，自定义域名和原始域名一样，会造成：\n\n1. 回源失败 – 因为回源的时候可能通过DNS重新访问到加速节点而非源站；\n2. 访问失败 – 源站部分内容并不在加速节点。\n\n法律规定自定义域名是ICP备案的，对源站没有要求。但是如果自定义域名本身的二级域名已经备案，则不需要再备案。\n\n## **是否支持HTTP标头gzip功能？**<a id=\"step25\"></a>\n\nAzure CDN支持HTTP标头的gzip功能，需要客户提交工单开通该功能。提交工单时请提供加速域名，源站域名，以及需要加速的文件类型。\n\n## **如果有多个订阅，如何在不同的订阅间切换？**<a id=\"step21\"></a>\n   \n如果您有多个订阅，如图所示，可以点击管理门户网站右上角订阅ID处的下拉三角，选择恰当的订阅ID。\n    \n![FAQ](./media/cdn-doc/FAQ.png)\n\n## **Azure账号过期，如何将CDN迁到另一个Azure账号？**<a id=\"step22\"></a>\n\n目前在订阅号之间的域名自动迁移还不支持。客户需要手工迁移。先从过期的订阅删除已有域名，然后在新的订阅中重新创建，并且会对域名重新进行审核。\n    \n##**一个账户内是否对本账户添加的加速域名个数有限制？**<a id=\"step10\"></a>\n\nAzure CDN对每个账户的加速域名个数没有做限制。"
}