{
  "nodes": [
    {
      "content": "Azure 虚拟机的计划内维护",
      "pos": [
        27,
        42
      ]
    },
    {
      "content": "了解什么是 Azure 计划内维护以及它如何影响正在 Azure 中运行的虚拟机。",
      "pos": [
        61,
        102
      ]
    },
    {
      "content": "Azure 虚拟机的计划内维护",
      "pos": [
        319,
        334
      ]
    },
    {
      "content": "Azure 为何要执行计划内维护",
      "pos": [
        339,
        355
      ]
    },
    {
      "content": "Azure 在全球范围内定期执行更新，以提高虚拟机所基于的主机基础结构的可靠性、性能及安全性。其中许多更新在执行时不会对虚拟机或云服务产生任何影响，其中包括内存保留更新。",
      "pos": [
        360,
        445
      ]
    },
    {
      "content": "不过，有些更新就需要重新启动虚拟机，以便向基础结构应用所需的更新。虚拟机会在我们修补基础结构时关闭，之后再重新启动。",
      "pos": [
        447,
        505
      ]
    },
    {
      "pos": [
        507,
        592
      ],
      "content": "请注意，有两类维护可能会影响虚拟机的可用性：计划内维护和计划外维护。本页介绍 Azure 如何执行计划内维护。有关计划外维护的详细信息，请参阅<bpt id=\"p1\">[</bpt><ept id=\"p1\">了解计划内与计划外维护]</ept>。"
    },
    {
      "content": "内存保留更新",
      "pos": [
        597,
        603
      ]
    },
    {
      "content": "对于 Azure 中的某一类更新，客户会发现它们对正在运行的虚拟机没有任何影响。其中一些更新主要面向组件或服务，更新时不会干扰正在运行的实例。还有一些更新是主机操作系统上的平台基础结构更新，应用时无需完全重启虚拟机。",
      "pos": [
        604,
        712
      ]
    },
    {
      "content": "这些更新借助支持实时迁移的技术（“内存保留”更新）来实现。更新时，虚拟机进入“暂停”状态，以保留 RAM 中的内存，基础主机操作系统则接收必要的更新和补丁。虚拟机在暂停后 30 秒内恢复正常。恢复后，虚拟机的时钟将自动同步。",
      "pos": [
        714,
        826
      ]
    },
    {
      "content": "并非所有更新都可以通过使用此机制来部署，但是如果提供短暂的暂停期，采用此方法部署更新将大幅减少对虚拟机的影响。",
      "pos": [
        828,
        883
      ]
    },
    {
      "content": "多实例更新（针对可用性集中的虚拟机）一次只应用于一个更新域。",
      "pos": [
        885,
        915
      ]
    },
    {
      "content": "虚拟机配置",
      "pos": [
        920,
        925
      ]
    },
    {
      "content": "虚拟机配置分两种：多实例和单实例。在多实例配置中，相似的虚拟机放在一个可用性集中。",
      "pos": [
        926,
        967
      ]
    },
    {
      "content": "多实例配置可提供冗余，若要确保应用程序的可用性，建议采用此配置。可用性集中的所有虚拟机应几乎相同，并且对应用程序具有相同的用途。",
      "pos": [
        969,
        1033
      ]
    },
    {
      "pos": [
        1035,
        1130
      ],
      "content": "有关配置虚拟机的高可用性的详细信息，请参阅<bpt id=\"p1\">[</bpt>管理虚拟机的可用性<ept id=\"p1\">](/documentation/articles/virtual-machines-manage-availability)</ept>。"
    },
    {
      "content": "相反，单实例配置用于不在一个可用性集中的独立虚拟机。这些虚拟机不符合服务级别协议 (SLA) 的要求，SLA 要求在同一个可用性集下部署两个或更多虚拟机。",
      "pos": [
        1132,
        1209
      ]
    },
    {
      "pos": [
        1211,
        1274
      ],
      "content": "有关 SLA 的详细信息，请参阅<bpt id=\"p1\">[</bpt>服务级别协议<ept id=\"p1\">](/support/legal/sla)</ept>中的“云服务、虚拟机和虚拟网络”一节。"
    },
    {
      "content": "多实例配置更新",
      "pos": [
        1280,
        1287
      ]
    },
    {
      "content": "在计划内维护期间，Azure 平台会先更新多实例配置中托管的虚拟机集。这将导致这些虚拟机重新启动。",
      "pos": [
        1288,
        1337
      ]
    },
    {
      "content": "在多实例配置更新中，虚拟机在整个更新过程中都将保持可用性，但前提是可用性集中每个虚拟机的用途都与其他虚拟机相似。",
      "pos": [
        1339,
        1395
      ]
    },
    {
      "content": "基础 Azure 平台为可用性集中的每个虚拟机分配一个更新域和一个容错域。每个更新域是一组在相同时间范围内重新启动的虚拟机。每个容错域是一组共用一个通用电源和网络交换机的虚拟机。",
      "pos": [
        1397,
        1486
      ]
    },
    {
      "pos": [
        1488,
        1663
      ],
      "content": "有关更新域和容错域的详细信息，请参阅<bpt id=\"p1\">[</bpt>配置可用性集中的多个虚拟机以实现冗余<ept id=\"p1\">](/documentation/articles/virtual-machines-manage-availability#configure-multiple-virtual-machines-in-an-availability-set-for-redundancy)</ept>。"
    },
    {
      "content": "为防止更新域同时脱机，将通过以下方式执行维护：关闭某个更新域中的所有虚拟机，向主机应用更新，重新启动虚拟机，然后继续对下一个更新域执行相同操作。更新完所有更新域之后，计划内维护事件即结束。",
      "pos": [
        1665,
        1759
      ]
    },
    {
      "content": "在计划内维护期间，更新域的重启顺序可能不会按序进行，但一次只重启一个更新域。现在，Azure 为多实例配置中虚拟机的计划内维护提供 48 小时高级通知功能。",
      "pos": [
        1761,
        1839
      ]
    },
    {
      "content": "虚拟机还原后，下面的示例演示了 Windows 事件查看器可能会显示的内容：",
      "pos": [
        1841,
        1879
      ]
    },
    {
      "content": "单实例配置更新",
      "pos": [
        1920,
        1927
      ]
    },
    {
      "content": "完成多实例配置更新后，Azure 将执行单实例配置更新。此更新也会导致不在可用性集中运行的虚拟机重新启动。",
      "pos": [
        1928,
        1981
      ]
    },
    {
      "content": "请注意，即使可用性集中只有一个实例在运行，Azure 平台也会将其视作多实例配置更新。",
      "pos": [
        1983,
        2026
      ]
    },
    {
      "content": "对于单实例配置中的虚拟机，将通过以下方式更新虚拟机：关闭虚拟机，向主机应用更新，然后重新启动虚拟机。这些更新将在单一维护时段内跨某个区域中的所有虚拟机运行。",
      "pos": [
        2028,
        2106
      ]
    },
    {
      "content": "对于这一类型的虚拟机配置，此计划内维护事件将影响应用程序的可用性。Azure 为单实例配置中虚拟机的计划内维护提供 1 周高级通知功能。",
      "pos": [
        2108,
        2176
      ]
    },
    {
      "content": "电子邮件通知",
      "pos": [
        2182,
        2188
      ]
    },
    {
      "content": "Azure 会提前发送电子邮件通信，提醒你即将执行计划内维护（单实例提前 1 周，多实例提前 48 小时），该功能仅适用于单实例和多实例虚拟机配置。此电子邮件将发送到订阅提供的主电子邮件帐户。",
      "pos": [
        2189,
        2285
      ]
    }
  ],
  "content": "<properties\n    pageTitle=\"Azure 虚拟机的计划内维护\"\n    description=\"了解什么是 Azure 计划内维护以及它如何影响正在 Azure 中运行的虚拟机。\"\n    services=\"virtual-machines\"\n    documentationCenter=\"\"\n    authors=\"kenazk\"\n    manager=\"timlt\"\n    editor=\"\"/>\n\n<tags\n    ms.service=\"virtual-machines\"\n    ms.date=\"07/23/2015\"\n    wacn.date=\"12/16/2015\"/>\n\n\n# Azure 虚拟机的计划内维护\n\n## Azure 为何要执行计划内维护\n<p> Azure 在全球范围内定期执行更新，以提高虚拟机所基于的主机基础结构的可靠性、性能及安全性。其中许多更新在执行时不会对虚拟机或云服务产生任何影响，其中包括内存保留更新。\n\n不过，有些更新就需要重新启动虚拟机，以便向基础结构应用所需的更新。虚拟机会在我们修补基础结构时关闭，之后再重新启动。\n\n请注意，有两类维护可能会影响虚拟机的可用性：计划内维护和计划外维护。本页介绍 Azure 如何执行计划内维护。有关计划外维护的详细信息，请参阅[了解计划内与计划外维护]。\n\n## 内存保留更新\n对于 Azure 中的某一类更新，客户会发现它们对正在运行的虚拟机没有任何影响。其中一些更新主要面向组件或服务，更新时不会干扰正在运行的实例。还有一些更新是主机操作系统上的平台基础结构更新，应用时无需完全重启虚拟机。\n\n这些更新借助支持实时迁移的技术（“内存保留”更新）来实现。更新时，虚拟机进入“暂停”状态，以保留 RAM 中的内存，基础主机操作系统则接收必要的更新和补丁。虚拟机在暂停后 30 秒内恢复正常。恢复后，虚拟机的时钟将自动同步。\n\n并非所有更新都可以通过使用此机制来部署，但是如果提供短暂的暂停期，采用此方法部署更新将大幅减少对虚拟机的影响。\n\n多实例更新（针对可用性集中的虚拟机）一次只应用于一个更新域。\n\n## 虚拟机配置\n虚拟机配置分两种：多实例和单实例。在多实例配置中，相似的虚拟机放在一个可用性集中。\n\n多实例配置可提供冗余，若要确保应用程序的可用性，建议采用此配置。可用性集中的所有虚拟机应几乎相同，并且对应用程序具有相同的用途。\n\n有关配置虚拟机的高可用性的详细信息，请参阅[管理虚拟机的可用性](/documentation/articles/virtual-machines-manage-availability)。\n\n相反，单实例配置用于不在一个可用性集中的独立虚拟机。这些虚拟机不符合服务级别协议 (SLA) 的要求，SLA 要求在同一个可用性集下部署两个或更多虚拟机。\n\n有关 SLA 的详细信息，请参阅[服务级别协议](/support/legal/sla)中的“云服务、虚拟机和虚拟网络”一节。\n\n\n## 多实例配置更新\n在计划内维护期间，Azure 平台会先更新多实例配置中托管的虚拟机集。这将导致这些虚拟机重新启动。\n\n在多实例配置更新中，虚拟机在整个更新过程中都将保持可用性，但前提是可用性集中每个虚拟机的用途都与其他虚拟机相似。\n\n基础 Azure 平台为可用性集中的每个虚拟机分配一个更新域和一个容错域。每个更新域是一组在相同时间范围内重新启动的虚拟机。每个容错域是一组共用一个通用电源和网络交换机的虚拟机。\n\n有关更新域和容错域的详细信息，请参阅[配置可用性集中的多个虚拟机以实现冗余](/documentation/articles/virtual-machines-manage-availability#configure-multiple-virtual-machines-in-an-availability-set-for-redundancy)。\n\n为防止更新域同时脱机，将通过以下方式执行维护：关闭某个更新域中的所有虚拟机，向主机应用更新，重新启动虚拟机，然后继续对下一个更新域执行相同操作。更新完所有更新域之后，计划内维护事件即结束。\n\n在计划内维护期间，更新域的重启顺序可能不会按序进行，但一次只重启一个更新域。现在，Azure 为多实例配置中虚拟机的计划内维护提供 48 小时高级通知功能。\n\n虚拟机还原后，下面的示例演示了 Windows 事件查看器可能会显示的内容：\n\n<!--Image reference-->\n![][image2]\n\n## 单实例配置更新\n完成多实例配置更新后，Azure 将执行单实例配置更新。此更新也会导致不在可用性集中运行的虚拟机重新启动。\n\n请注意，即使可用性集中只有一个实例在运行，Azure 平台也会将其视作多实例配置更新。\n\n对于单实例配置中的虚拟机，将通过以下方式更新虚拟机：关闭虚拟机，向主机应用更新，然后重新启动虚拟机。这些更新将在单一维护时段内跨某个区域中的所有虚拟机运行。\n\n对于这一类型的虚拟机配置，此计划内维护事件将影响应用程序的可用性。Azure 为单实例配置中虚拟机的计划内维护提供 1 周高级通知功能。\n\n### 电子邮件通知\nAzure 会提前发送电子邮件通信，提醒你即将执行计划内维护（单实例提前 1 周，多实例提前 48 小时），该功能仅适用于单实例和多实例虚拟机配置。此电子邮件将发送到订阅提供的主电子邮件帐户。\n\n<!--Image reference-->\n\n\n<!--Anchors-->\n[image1]: ./media/virtual-machines-planned-maintenance/vmplanned1.png\n[image2]: ./media/virtual-machines-planned-maintenance/EventViewerPostReboot.png\n[image3]: ./media/virtual-machines-planned-maintenance/RegionPairs.PNG\n\n\n<!--Link references-->\n[Virtual Machines Manage Availability]: /documentation/articles/virtual-machines-windows-tutorial-classic-portal\n[了解计划内与计划外维护]: /documentation/articles/virtual-machines-manage-availability#Understand-planned-versus-unplanned-maintenance\n<!---HONumber=70-->"
}