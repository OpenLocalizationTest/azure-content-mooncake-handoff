{
  "nodes": [
    {
      "content": "什么是网络访问控制列表 (ACL)？",
      "pos": [
        27,
        45
      ]
    },
    {
      "content": "了解 ACL",
      "pos": [
        63,
        69
      ]
    },
    {
      "content": "什么是终结点访问控制列表 (ACL)？",
      "pos": [
        293,
        312
      ]
    },
    {
      "content": "终结点访问控制列表 (ACL) 是可用于 Azure 部署的安全增强。利用 ACL，你可以选择允许还是拒绝虚拟机终结点的流量。此数据包筛选功能额外提供了一层安全性。你只能为终结点指定网络 ACL，而无法为虚拟网络或虚拟网络中包含的特定子网指定 ACL。",
      "pos": [
        314,
        440
      ]
    },
    {
      "pos": [
        444,
        567
      ],
      "content": "<ph id=\"ph1\">[AZURE.IMPORTANT]</ph>建议你尽可能地使用网络安全组 (NSG) 而不是 ACL。若要了解有关 NSG 的详细信息，请参阅<bpt id=\"p1\">[</bpt>什么是网络安全组<ept id=\"p1\">](/documentation/articles/virtual-networks-nsg)</ept>。"
    },
    {
      "pos": [
        569,
        812
      ],
      "content": "可以使用 PowerShell 或在管理门户中配置 ACL。若要使用 PowerShell 配置网络 ACL，请参阅<bpt id=\"p1\">[</bpt>使用 PowerShell 管理终结点的访问控制列表 (ACL)<ept id=\"p1\">](/documentation/articles/virtual-networks-acl-powershell)</ept>。若要使用管理门户配置网络 ACL，请参阅<bpt id=\"p2\">[</bpt>如何设置虚拟机的终结点<ept id=\"p2\">](/documentation/articles/virtual-machines-set-up-endpoints)</ept>。"
    },
    {
      "content": "使用网络 ACL 可以实现以下目的：",
      "pos": [
        814,
        832
      ]
    },
    {
      "content": "根据远程子网 IPv4 地址范围选择允许还是拒绝传入流量流向虚拟机输入终结点。",
      "pos": [
        836,
        875
      ]
    },
    {
      "content": "方块列表 IP 地址",
      "pos": [
        879,
        889
      ]
    },
    {
      "content": "为每个虚拟机终结点创建多个规则",
      "pos": [
        893,
        908
      ]
    },
    {
      "content": "为每个虚拟机终结点指定最多 50 个 ACL 规则",
      "pos": [
        912,
        937
      ]
    },
    {
      "content": "使用规则排序可确保将一组正确的规则应用于给定的虚拟机终结点（最低到最高）",
      "pos": [
        941,
        977
      ]
    },
    {
      "content": "为特定远程子网 IPv4 地址指定 ACL。",
      "pos": [
        981,
        1003
      ]
    },
    {
      "content": "ACL 的工作原理",
      "pos": [
        1008,
        1017
      ]
    },
    {
      "content": "ACL 是包含规则列表的对象。当你创建 ACL 并将其应用于虚拟机终结点时，数据包筛选将在 VM 的主机节点上发生。这意味着，来自远程 IP 地址的流量将通过主机节点筛选以匹配 ACL 规则，而不是在你的 VM 上进行筛选。这可以防止 VM 将宝贵的 CPU 周期耗费在数据包筛选上。",
      "pos": [
        1019,
        1161
      ]
    },
    {
      "content": "创建虚拟机时，将会设置一个默认 ACL 来阻止所有传入流量。但是，如果创建了一个终结点（针对端口 3389），则会修改默认 ACL 以允许该终结点的所有入站流量。随后，将允许来自任何远程子网的传入流量流向该终结点，而且不需要配置防火墙。除非为这些端口创建了终结点，否则将阻止所有其他端口的传入流量。默认情况下允许出站流量。",
      "pos": [
        1163,
        1324
      ]
    },
    {
      "content": "默认 ACL 表示例",
      "pos": [
        1328,
        1338
      ]
    },
    {
      "content": "规则编号",
      "pos": [
        1346,
        1350
      ]
    },
    {
      "content": "远程子网",
      "pos": [
        1357,
        1361
      ]
    },
    {
      "content": "终结点",
      "pos": [
        1368,
        1371
      ]
    },
    {
      "content": "允许/拒绝",
      "pos": [
        1378,
        1383
      ]
    },
    {
      "content": "100",
      "pos": [
        1442,
        1445
      ]
    },
    {
      "content": "0\\.0.0.0/0",
      "pos": [
        1448,
        1458
      ]
    },
    {
      "content": "3389",
      "pos": [
        1461,
        1465
      ]
    },
    {
      "content": "允许",
      "pos": [
        1468,
        1470
      ]
    },
    {
      "content": "允许和拒绝",
      "pos": [
        1477,
        1482
      ]
    },
    {
      "content": "你可以通过创建指定“允许”或“拒绝”的规则来选择允许还是拒绝虚拟机输入终结点的网络流量。请务必注意，默认情况下，在创建一个终结点后，将拒绝所有流量流向该终结点。因此，如果你希望精确地控制你选择允许访问虚拟机终结点的网络流量，则了解如何创建允许/拒绝规则并按正确的优先顺序放置它们非常重要。",
      "pos": [
        1484,
        1628
      ]
    },
    {
      "content": "考虑的要点：",
      "pos": [
        1630,
        1636
      ]
    },
    {
      "pos": [
        1641,
        1683
      ],
      "content": "<bpt id=\"p1\">**</bpt>无 ACL<ept id=\"p1\">**</ept> - 默认情况下，在创建一个终结点后，我们将允许终结点的所有流量。"
    },
    {
      "pos": [
        1688,
        1760
      ],
      "content": "<bpt id=\"p1\">**</bpt>允许<ept id=\"p1\">**</ept> - 默认情况，在添加一个或多个“允许”范围后，你将拒绝所有其他范围。只有来自允许的 IP 范围的数据包才能与虚拟机终结点进行通信。"
    },
    {
      "pos": [
        1765,
        1809
      ],
      "content": "<bpt id=\"p1\">**</bpt>拒绝<ept id=\"p1\">**</ept> - 默认情况，在添加一个或多个“拒绝”范围后，你将允许所有其他范围的流量。"
    },
    {
      "pos": [
        1814,
        1865
      ],
      "content": "<bpt id=\"p1\">**</bpt>允许和拒绝的组合<ept id=\"p1\">**</ept> - 当你要指定允许或拒绝的特定 IP 范围时，可结合使用“允许”和“拒绝”。"
    },
    {
      "content": "规则和规则优先顺序",
      "pos": [
        1870,
        1879
      ]
    },
    {
      "pos": [
        1881,
        2025
      ],
      "content": "可对特定虚拟机终结点设置网络 ACL。例如，你可以为在虚拟机上创建的 RDP 终结点指定一个网络 ACL，它将锁定对某些 IP 地址的访问。下表显示了如何为某个范围的公共虚拟 IP (VIP) 授予访问权限以允许访问 RDP。将拒绝所有其他远程 IP。我们将采用<bpt id=\"p1\">*</bpt>越小越优先<ept id=\"p1\">*</ept>的规则顺序。"
    },
    {
      "content": "多个规则",
      "pos": [
        2031,
        2035
      ]
    },
    {
      "content": "在以下示例中，如果你希望仅允许两个公共 IPv4 地址范围（65.0.0.0/8 和 159.0.0.0/8）内的 IP 访问 RDP 终结点，则可以通过指定两个“允许”规则来实现。在这种情况下，由于系统会默认为虚拟机创建 RDP，你可能希望基于远程子网锁定对 RDP 端口的访问。下面的示例显示了如何为某个范围的公共虚拟 IP (VIP) 授予访问权限以允许访问 RDP。将拒绝所有其他远程 IP。由于可为特定虚拟机终结点设置网络 ACL 访问且在默认情况下访问会被拒绝，因此这种方法很有用。",
      "pos": [
        2037,
        2284
      ]
    },
    {
      "content": "示例 - 多个规则",
      "pos": [
        2288,
        2297
      ]
    },
    {
      "content": "规则编号",
      "pos": [
        2305,
        2309
      ]
    },
    {
      "content": "远程子网",
      "pos": [
        2316,
        2320
      ]
    },
    {
      "content": "终结点",
      "pos": [
        2327,
        2330
      ]
    },
    {
      "content": "允许/拒绝",
      "pos": [
        2337,
        2342
      ]
    },
    {
      "content": "100",
      "pos": [
        2401,
        2404
      ]
    },
    {
      "content": "65\\.0.0.0/8",
      "pos": [
        2407,
        2418
      ]
    },
    {
      "content": "3389",
      "pos": [
        2421,
        2425
      ]
    },
    {
      "content": "允许",
      "pos": [
        2428,
        2430
      ]
    },
    {
      "content": "200",
      "pos": [
        2435,
        2438
      ]
    },
    {
      "content": "159\\.0.0.0/8",
      "pos": [
        2441,
        2453
      ]
    },
    {
      "content": "3389",
      "pos": [
        2456,
        2460
      ]
    },
    {
      "content": "允许",
      "pos": [
        2463,
        2465
      ]
    },
    {
      "content": "规则顺序",
      "pos": [
        2473,
        2477
      ]
    },
    {
      "pos": [
        2479,
        2701
      ],
      "content": "由于可为一个终结点指定多个规则，因此必须有一种方法来组织规则以确定哪个规则优先。规则顺序决定了优先顺序。网络 ACL 将采用<bpt id=\"p1\">*</bpt>越小越优先<ept id=\"p1\">*</ept>的规则顺序。在以下示例中，选择性地为端口 80 上的终结点授予了对某些 IP 地址范围的访问权限。为了进行此配置，我们制定了针对 175.1.0.1/24 范围内的地址的拒绝规则（规则号 100）。然后，我们指定了优先顺序为 200 的第二个规则，该规则允许访问 175.0.0.0/8 下的所有其他地址。"
    },
    {
      "content": "示例 - 规则优先顺序",
      "pos": [
        2705,
        2716
      ]
    },
    {
      "content": "规则编号",
      "pos": [
        2724,
        2728
      ]
    },
    {
      "content": "远程子网",
      "pos": [
        2735,
        2739
      ]
    },
    {
      "content": "终结点",
      "pos": [
        2746,
        2749
      ]
    },
    {
      "content": "允许/拒绝",
      "pos": [
        2756,
        2761
      ]
    },
    {
      "content": "100",
      "pos": [
        2820,
        2823
      ]
    },
    {
      "content": "175\\.1.0.1/24",
      "pos": [
        2826,
        2839
      ]
    },
    {
      "content": "80",
      "pos": [
        2842,
        2844
      ]
    },
    {
      "content": "拒绝",
      "pos": [
        2847,
        2849
      ]
    },
    {
      "content": "200",
      "pos": [
        2854,
        2857
      ]
    },
    {
      "content": "175\\.0.0.0/8",
      "pos": [
        2860,
        2872
      ]
    },
    {
      "content": "80",
      "pos": [
        2875,
        2877
      ]
    },
    {
      "content": "允许",
      "pos": [
        2880,
        2882
      ]
    },
    {
      "content": "网络 ACL 和负载平衡的集",
      "pos": [
        2889,
        2903
      ]
    },
    {
      "content": "网络 ACL 可在负载平衡集（LB 集）终结点上指定。如果为 LB 集指定了 ACL，则网络 ACL 将应用于该 LB 集中的所有虚拟机。例如，如果使用“端口 80”创建了 LB 集，并且 LB 集包含 3 个 VM，则在一台 VM 的终结点“端口 80”上创建的网络 ACL 将自动应用于其他 VM。",
      "pos": [
        2905,
        3056
      ]
    },
    {
      "content": "网络 ACL 和负载平衡的集",
      "pos": [
        3060,
        3074
      ]
    },
    {
      "content": "后续步骤",
      "pos": [
        3123,
        3127
      ]
    },
    {
      "content": "如何使用 PowerShell 管理终结点的访问控制列表 (ACL)",
      "pos": [
        3130,
        3164
      ]
    }
  ],
  "content": "<properties \n   pageTitle=\"什么是网络访问控制列表 (ACL)？\"\n   description=\"了解 ACL\"\n   services=\"virtual-network\"\n   documentationCenter=\"na\"\n   authors=\"telmosampaio\"\n   manager=\"carolz\"\n   editor=\"tysonn\" />\n<tags\n    ms.service=\"virtual-network\"\n    ms.date=\"12/11/2015\"\n    wacn.date=\"01/14/2016\"/>\n\n# 什么是终结点访问控制列表 (ACL)？\n\n终结点访问控制列表 (ACL) 是可用于 Azure 部署的安全增强。利用 ACL，你可以选择允许还是拒绝虚拟机终结点的流量。此数据包筛选功能额外提供了一层安全性。你只能为终结点指定网络 ACL，而无法为虚拟网络或虚拟网络中包含的特定子网指定 ACL。\n\n> [AZURE.IMPORTANT]建议你尽可能地使用网络安全组 (NSG) 而不是 ACL。若要了解有关 NSG 的详细信息，请参阅[什么是网络安全组](/documentation/articles/virtual-networks-nsg)。\n\n可以使用 PowerShell 或在管理门户中配置 ACL。若要使用 PowerShell 配置网络 ACL，请参阅[使用 PowerShell 管理终结点的访问控制列表 (ACL)](/documentation/articles/virtual-networks-acl-powershell)。若要使用管理门户配置网络 ACL，请参阅[如何设置虚拟机的终结点](/documentation/articles/virtual-machines-set-up-endpoints)。\n\n使用网络 ACL 可以实现以下目的：\n\n- 根据远程子网 IPv4 地址范围选择允许还是拒绝传入流量流向虚拟机输入终结点。\n\n- 方块列表 IP 地址\n\n- 为每个虚拟机终结点创建多个规则\n\n- 为每个虚拟机终结点指定最多 50 个 ACL 规则\n\n- 使用规则排序可确保将一组正确的规则应用于给定的虚拟机终结点（最低到最高）\n\n- 为特定远程子网 IPv4 地址指定 ACL。\n\n## ACL 的工作原理\n\nACL 是包含规则列表的对象。当你创建 ACL 并将其应用于虚拟机终结点时，数据包筛选将在 VM 的主机节点上发生。这意味着，来自远程 IP 地址的流量将通过主机节点筛选以匹配 ACL 规则，而不是在你的 VM 上进行筛选。这可以防止 VM 将宝贵的 CPU 周期耗费在数据包筛选上。\n\n创建虚拟机时，将会设置一个默认 ACL 来阻止所有传入流量。但是，如果创建了一个终结点（针对端口 3389），则会修改默认 ACL 以允许该终结点的所有入站流量。随后，将允许来自任何远程子网的传入流量流向该终结点，而且不需要配置防火墙。除非为这些端口创建了终结点，否则将阻止所有其他端口的传入流量。默认情况下允许出站流量。\n\n**默认 ACL 表示例**\n\n| **规则编号** | **远程子网** | **终结点** | **允许/拒绝** |\n|--------|---------------|----------|-------------|\n| 100 | 0\\.0.0.0/0 | 3389 | 允许 |\n\n## 允许和拒绝\n\n你可以通过创建指定“允许”或“拒绝”的规则来选择允许还是拒绝虚拟机输入终结点的网络流量。请务必注意，默认情况下，在创建一个终结点后，将拒绝所有流量流向该终结点。因此，如果你希望精确地控制你选择允许访问虚拟机终结点的网络流量，则了解如何创建允许/拒绝规则并按正确的优先顺序放置它们非常重要。\n\n考虑的要点：\n\n1. **无 ACL** - 默认情况下，在创建一个终结点后，我们将允许终结点的所有流量。\n\n1. **允许** - 默认情况，在添加一个或多个“允许”范围后，你将拒绝所有其他范围。只有来自允许的 IP 范围的数据包才能与虚拟机终结点进行通信。\n\n1. **拒绝** - 默认情况，在添加一个或多个“拒绝”范围后，你将允许所有其他范围的流量。\n\n1. **允许和拒绝的组合** - 当你要指定允许或拒绝的特定 IP 范围时，可结合使用“允许”和“拒绝”。\n\n## 规则和规则优先顺序\n\n可对特定虚拟机终结点设置网络 ACL。例如，你可以为在虚拟机上创建的 RDP 终结点指定一个网络 ACL，它将锁定对某些 IP 地址的访问。下表显示了如何为某个范围的公共虚拟 IP (VIP) 授予访问权限以允许访问 RDP。将拒绝所有其他远程 IP。我们将采用*越小越优先*的规则顺序。\n\n### 多个规则\n\n在以下示例中，如果你希望仅允许两个公共 IPv4 地址范围（65.0.0.0/8 和 159.0.0.0/8）内的 IP 访问 RDP 终结点，则可以通过指定两个“允许”规则来实现。在这种情况下，由于系统会默认为虚拟机创建 RDP，你可能希望基于远程子网锁定对 RDP 端口的访问。下面的示例显示了如何为某个范围的公共虚拟 IP (VIP) 授予访问权限以允许访问 RDP。将拒绝所有其他远程 IP。由于可为特定虚拟机终结点设置网络 ACL 访问且在默认情况下访问会被拒绝，因此这种方法很有用。\n\n**示例 - 多个规则**\n\n| **规则编号** | **远程子网** | **终结点** | **允许/拒绝** |\n|--------|---------------|----------|-------------|\n| 100 | 65\\.0.0.0/8 | 3389 | 允许 |\n| 200 | 159\\.0.0.0/8 | 3389 | 允许 |\n\n### 规则顺序\n\n由于可为一个终结点指定多个规则，因此必须有一种方法来组织规则以确定哪个规则优先。规则顺序决定了优先顺序。网络 ACL 将采用*越小越优先*的规则顺序。在以下示例中，选择性地为端口 80 上的终结点授予了对某些 IP 地址范围的访问权限。为了进行此配置，我们制定了针对 175.1.0.1/24 范围内的地址的拒绝规则（规则号 100）。然后，我们指定了优先顺序为 200 的第二个规则，该规则允许访问 175.0.0.0/8 下的所有其他地址。\n\n**示例 - 规则优先顺序**\n\n| **规则编号** | **远程子网** | **终结点** | **允许/拒绝** |\n|--------|---------------|----------|-------------|\n| 100 | 175\\.1.0.1/24 | 80 | 拒绝 |\n| 200 | 175\\.0.0.0/8 | 80 | 允许 |\n\n## 网络 ACL 和负载平衡的集\n\n网络 ACL 可在负载平衡集（LB 集）终结点上指定。如果为 LB 集指定了 ACL，则网络 ACL 将应用于该 LB 集中的所有虚拟机。例如，如果使用“端口 80”创建了 LB 集，并且 LB 集包含 3 个 VM，则在一台 VM 的终结点“端口 80”上创建的网络 ACL 将自动应用于其他 VM。\n\n![网络 ACL 和负载平衡的集](./media/virtual-networks-acl/IC674733.png)\n\n## 后续步骤\n\n[如何使用 PowerShell 管理终结点的访问控制列表 (ACL)](/documentation/articles/virtual-networks-acl-powershell)\n\n<!---HONumber=79-->"
}