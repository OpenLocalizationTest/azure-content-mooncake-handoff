{
  "nodes": [
    {
      "content": "使用 Azure PowerShell 在 HDInsight 中创建基于 Windows 的 Hadoop 群集 | Azure",
      "pos": [
        26,
        91
      ]
    },
    {
      "content": "了解如何使用 Azure PowerShell 创建 Azure HDInsight 的群集。",
      "pos": [
        110,
        157
      ]
    },
    {
      "content": "使用 Azure PowerShell 在 HDInsight 中创建基于 Windows 的 Hadoop 群集",
      "pos": [
        388,
        445
      ]
    },
    {
      "pos": [
        447,
        526
      ],
      "content": "[AZURE.INCLUDE <bpt id=\"p1\">[</bpt>选择器<ept id=\"p1\">](../includes/hdinsight-create-windows-cluster-selector.md)</ept>]"
    },
    {
      "pos": [
        528,
        758
      ],
      "content": "了解如何使用 Azure PowerShell 创建 HDInsight 群集。Azure PowerShell 是一个模块，提供用于通过 Windows PowerShell 管理 Azure 的 cmdlet。有关其他群集创建工具和功能，请单击本页面顶部的相应选项卡，或参阅<bpt id=\"p1\">[</bpt>群集创建方法<ept id=\"p1\">](/documentation/articles/hdinsight-provision-clusters-v1#cluster-creation-methods)</ept>。"
    },
    {
      "content": "先决条件：",
      "pos": [
        764,
        769
      ]
    },
    {
      "content": "在开始按照本文中的说明操作之前，你必须具有以下内容：",
      "pos": [
        771,
        797
      ]
    },
    {
      "pos": [
        801,
        857
      ],
      "content": "Azure 订阅创建新存储帐户。请参阅<bpt id=\"p1\">[</bpt>获取 Azure 试用版<ept id=\"p1\">](/pricing/1rmb-trial/)</ept>。"
    },
    {
      "pos": [
        860,
        1006
      ],
      "content": "Azure PowerShell。参阅<bpt id=\"p1\">[</bpt>安装 Azure PowerShell 1.0<ept id=\"p1\">](/documentation/articles/hdinsight-administer-use-powershell#install-azure-powershell-10-and-greater)</ept>。"
    },
    {
      "content": "创建群集",
      "pos": [
        1013,
        1017
      ]
    },
    {
      "pos": [
        1018,
        1530
      ],
      "content": "Azure PowerShell 是一个功能强大的脚本编写环境，可用于在 Azure 中控制和自动执行工作负荷的部署和管理。本部分提供有关如何通过使用 Azure PowerShell 创建 HDInsight 群集的说明。有关配置工作站以运行 HDInsight Windows Powershell cmdlet 的信息，请参阅<bpt id=\"p1\">[</bpt>安装和配置 Azure PowerShell<ept id=\"p1\">](/documentation/articles/powershell-install-configure)</ept>。有关将 Azure PowerShell 与 HDInsight 配合使用的详细信息，请参阅<bpt id=\"p2\">[</bpt>使用 PowerShell 管理 HDInsight<ept id=\"p2\">](/documentation/articles/hdinsight-administer-use-powershell)</ept>。有关 HDInsight Windows PowerShell cmdlet 的列表，请参阅 <bpt id=\"p3\">[</bpt>HDInsight cmdlet 参考<ept id=\"p3\">](https://msdn.microsoft.com/zh-cn/library/azure/dn858087.aspx)</ept>。"
    },
    {
      "content": "通过使用 Azure PowerShell 创建 HDInsight 群集需要执行以下过程：",
      "pos": [
        1533,
        1579
      ]
    },
    {
      "content": "自定义群集",
      "pos": [
        4576,
        4581
      ]
    },
    {
      "pos": [
        4585,
        4710
      ],
      "content": "参阅<bpt id=\"p1\">[</bpt>使用 Bootstrap 自定义 HDInsight 群集<ept id=\"p1\">](/documentation/articles/hdinsight-hadoop-customize-cluster-bootstrap#use-azure-powershell)</ept>。"
    },
    {
      "pos": [
        4713,
        4851
      ],
      "content": "参阅<bpt id=\"p1\">[</bpt>使用脚本操作自定义基于 Windows 的 HDInsight 群集<ept id=\"p1\">](/documentation/articles/hdinsight-hadoop-customize-cluster-v1#call-scripts-using-azure-powershell)</ept>。"
    },
    {
      "content": "后续步骤",
      "pos": [
        4856,
        4860
      ]
    },
    {
      "content": "在本文中，你已经学习了几种创建 HDInsight 群集的方法。若要了解更多信息，请参阅下列文章：",
      "pos": [
        4861,
        4910
      ]
    },
    {
      "pos": [
        4914,
        5034
      ],
      "content": "<bpt id=\"p1\">[</bpt>Azure HDInsight 入门<ept id=\"p1\">](/documentation/articles/hdinsight-hadoop-tutorial-get-started-windows-v1)</ept> - 了解如何开始使用你的 HDInsight 群集"
    },
    {
      "pos": [
        5037,
        5155
      ],
      "content": "<bpt id=\"p1\">[</bpt>以编程方式提交 Hadoop 作业<ept id=\"p1\">](/documentation/articles/hdinsight-submit-hadoop-jobs-programmatically)</ept> - 了解如何以编程方式将作业提交到 HDInsight"
    },
    {
      "pos": [
        5158,
        5299
      ],
      "content": "<bpt id=\"p1\">[</bpt>使用 PowerShell 管理 HDInsight 中的 Hadoop 群集<ept id=\"p1\">](/documentation/articles/hdinsight-administer-use-powershell)</ept> - 了解如何通过 Azure PowerShell 使用 HDInsight"
    },
    {
      "pos": [
        5302,
        5374
      ],
      "content": "<bpt id=\"p1\">[</bpt>Azure HDInsight SDK 文档<ept id=\"p1\">][hdinsight-sdk-documentation]</ept> - 探索 HDInsight SDK"
    }
  ],
  "content": "<properties\n   pageTitle=\"使用 Azure PowerShell 在 HDInsight 中创建基于 Windows 的 Hadoop 群集 | Azure\"\n    description=\"了解如何使用 Azure PowerShell 创建 Azure HDInsight 的群集。\"\n   services=\"hdinsight\"\n   documentationCenter=\"\"\n   tags=\"azure-portal\"\n   authors=\"mumian\"\n   manager=\"paulettm\"\n   editor=\"cgronlun\"/>\n\n<tags\n    ms.service=\"hdinsight\"\n    ms.date=\"01/04/2016\"\n    wacn.date=\"02/26/2016\"/>\n\n# 使用 Azure PowerShell 在 HDInsight 中创建基于 Windows 的 Hadoop 群集\n\n[AZURE.INCLUDE [选择器](../includes/hdinsight-create-windows-cluster-selector.md)]\n\n了解如何使用 Azure PowerShell 创建 HDInsight 群集。Azure PowerShell 是一个模块，提供用于通过 Windows PowerShell 管理 Azure 的 cmdlet。有关其他群集创建工具和功能，请单击本页面顶部的相应选项卡，或参阅[群集创建方法](/documentation/articles/hdinsight-provision-clusters-v1#cluster-creation-methods)。\n\n\n###先决条件：\n\n在开始按照本文中的说明操作之前，你必须具有以下内容：\n\n- Azure 订阅创建新存储帐户。请参阅[获取 Azure 试用版](/pricing/1rmb-trial/)。\n- Azure PowerShell。参阅[安装 Azure PowerShell 1.0](/documentation/articles/hdinsight-administer-use-powershell#install-azure-powershell-10-and-greater)。\n\n\n\n## 创建群集\nAzure PowerShell 是一个功能强大的脚本编写环境，可用于在 Azure 中控制和自动执行工作负荷的部署和管理。本部分提供有关如何通过使用 Azure PowerShell 创建 HDInsight 群集的说明。有关配置工作站以运行 HDInsight Windows Powershell cmdlet 的信息，请参阅[安装和配置 Azure PowerShell](/documentation/articles/powershell-install-configure)。有关将 Azure PowerShell 与 HDInsight 配合使用的详细信息，请参阅[使用 PowerShell 管理 HDInsight](/documentation/articles/hdinsight-administer-use-powershell)。有关 HDInsight Windows PowerShell cmdlet 的列表，请参阅 [HDInsight cmdlet 参考](https://msdn.microsoft.com/zh-cn/library/azure/dn858087.aspx)。\n\n\n通过使用 Azure PowerShell 创建 HDInsight 群集需要执行以下过程：\n\n    ####################################\n    # Set these variables\n    ####################################\n    #region - used for creating Azure service names\n    $nameToken = \"<Enter an Alias>\" \n    #endregion\n\n    #region - cluster user accounts\n    $httpUserName = \"admin\"  #HDInsight cluster username\n    $httpPassword = \"<Enter a Password>\"\n    #endregion\n\n    ###########################################\n    # Service names and varialbes\n    ###########################################\n    #region - service names\n    $namePrefix = $nameToken.ToLower() + (Get-Date -Format \"MMdd\")\n\n    $hdinsightClusterName = $namePrefix + \"hdi\"\n    $defaultStorageAccountName = $namePrefix + \"store\"\n    $defaultBlobContainerName = $hdinsightClusterName\n\n    $location = \"China East\"\n    $clusterSizeInNodes = 1\n    #endregion\n\n    # Treat all errors as terminating\n    $ErrorActionPreference = \"Stop\"\n\n    ###########################################\n    # Connect to Azure\n    ###########################################\n    #region - Connect to Azure subscription\n    Write-Host \"`nConnecting to your Azure subscription ...\" -ForegroundColor Green\n    try{Get-AzureContext}\n    catch{Add-AzureAccount -Environment AzureChinaCloud}\n    #endregion\n\n    ###########################################\n    # Preapre default storage account and container\n    ###########################################\n    New-AzureStorageAccount `\n        -StorageAccountName $defaultStorageAccountName `\n        -Type Standard_GRS `\n        -Location $location\n\n    $defaultStorageAccountKey = Get-AzureStorageKey `\n                                    -StorageAccountName $defaultStorageAccountName |  %{ $_.Primary }\n    $defaultStorageContext = New-AzureStorageContext `\n                                    -StorageAccountName $defaultStorageAccountName `\n                                    -StorageAccountKey $defaultStorageAccountKey\n    New-AzureStorageContainer `\n        -Name $hdinsightClusterName ` #use the cluster name as the container name\n        -Context $defaultStorageContext \n\n    ###########################################\n    # Create the cluster\n    ###########################################\n\n    $httpPW = ConvertTo-SecureString -String $httpPassword -AsPlainText -Force\n    $httpCredential = New-Object System.Management.Automation.PSCredential($httpUserName,$httpPW)\n\n    New-AzureHDInsightCluster `\n        -Name $hdinsightClusterName `\n        -Location $location `\n        -ClusterSizeInNodes $clusterSizeInNodes `\n        -ClusterType Hadoop `\n        -Version \"3.2\" `\n        -Credential $httpCredential `\n        -DefaultStorageAccountName \"$defaultStorageAccountName.blob.core.chinacloudapi.cn\" `\n        -DefaultStorageAccountKey $defaultStorageAccountKey `\n        -DefaultStorageContainerName $hdinsightClusterName \n\n    ####################################\n    # Verify the cluster\n    ####################################\n    Get-AzureHDInsightCluster -Name $hdinsightClusterName \n\n##自定义群集\n\n- 参阅[使用 Bootstrap 自定义 HDInsight 群集](/documentation/articles/hdinsight-hadoop-customize-cluster-bootstrap#use-azure-powershell)。\n- 参阅[使用脚本操作自定义基于 Windows 的 HDInsight 群集](/documentation/articles/hdinsight-hadoop-customize-cluster-v1#call-scripts-using-azure-powershell)。\n\n\n##后续步骤\n在本文中，你已经学习了几种创建 HDInsight 群集的方法。若要了解更多信息，请参阅下列文章：\n\n* [Azure HDInsight 入门](/documentation/articles/hdinsight-hadoop-tutorial-get-started-windows-v1) - 了解如何开始使用你的 HDInsight 群集\n* [以编程方式提交 Hadoop 作业](/documentation/articles/hdinsight-submit-hadoop-jobs-programmatically) - 了解如何以编程方式将作业提交到 HDInsight\n* [使用 PowerShell 管理 HDInsight 中的 Hadoop 群集](/documentation/articles/hdinsight-administer-use-powershell) - 了解如何通过 Azure PowerShell 使用 HDInsight\n* [Azure HDInsight SDK 文档][hdinsight-sdk-documentation] - 探索 HDInsight SDK\n\n\n\n\n[hdinsight-sdk-documentation]: http://msdn.microsoft.com/zh-cn/library/dn479185.aspx\n[azure-preview-portal]: https://manage.windowsazure.cn\n[connectionmanager]: http://msdn.microsoft.com/zh-cn/library/mt146773(v=sql.120).aspx\n[ssispack]: http://msdn.microsoft.com/zh-cn/library/mt146770(v=sql.120).aspx\n[ssisclustercreate]: http://msdn.microsoft.com/zh-cn/library/mt146774(v=sql.120).aspx\n[ssisclusterdelete]: http://msdn.microsoft.com/zh-cn/library/mt146778(v=sql.120).aspx\n\n<!---HONumber=Mooncake_0215_2016-->"
}