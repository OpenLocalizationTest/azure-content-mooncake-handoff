{
  "nodes": [
    {
      "content": "管理虚拟机的可用性",
      "pos": [
        150,
        159
      ]
    },
    {
      "pos": [
        162,
        388
      ],
      "content": "为了帮助确保您的应用程序的可用性，我们强烈建议使用可提供冗余的多台虚拟机。若要提供冗余，请配置多台虚拟机来执行相同的功能或角色。获得有保证的水平的服务需要此冗余。另请确保考虑依赖关系。例如，如果虚拟机“IIS1”依赖虚拟机“SQL1”提供的服务，“SQL2”将提供虚拟机“SQL1”的冗余来帮助避免服务中断。有关服务级别协议要求的更多信息，请参见<bpt id=\"p1\">[</bpt>服务级别协议<ept id=\"p1\">](/zh-cn/support/legal/sla)</ept>中的“云服务、虚拟机和虚拟网络”一节。"
    },
    {
      "content": "此方法可帮助确保在出现本地网络故障、本地磁盘硬件故障以及平台可能需要的任何计划内停机时，应用程序仍然可用。",
      "pos": [
        390,
        443
      ]
    },
    {
      "content": "通过将多台虚拟机添加到一个可用性集中，您可以管理使用这些虚拟机的应用程序的可用性。可用性集直接与容错域和更新域相关。通过避免单点（例如服务器机架上的网络交换机或电源设备）故障，可定义 Azure 中的容错域。事实上，容错域近似等同物理服务器机架。当多台虚拟机在云服务中连接在一起时，可用性集会将这些虚拟机放在不同的容错域中。下面的示意图显示两个可用性集，其中每个可用性集包含两台虚拟机。",
      "pos": [
        445,
        638
      ]
    },
    {
      "content": "更新域",
      "pos": [
        642,
        645
      ]
    },
    {
      "content": "Azure 定期更新承载应用程序实例的操作系统。在应用更新时，虚拟机将关闭。更新域用来确保不是所有虚拟机实例都在同一时间更新。当您将多台虚拟机分配到某个可用性集时，Azure 可确保这些虚拟机将分配到不同的更新域。上图显示两台运行 Internet Information Services (IIS) 的虚拟机位于不同的更新域中，两台运行 SQL Server 的虚拟机也位于不同的更新域中。",
      "pos": [
        698,
        895
      ]
    },
    {
      "pos": [
        897,
        970
      ],
      "content": "应结合使用可用性集和负载平衡终结点，以帮助确保应用程序始终可用并且高效运行。有关使用负载平衡终结点的更多信息，请参见<bpt id=\"p1\">[</bpt>对虚拟机进行负载平衡<ept id=\"p1\">][]</ept>。"
    },
    {
      "content": "此任务包括下列步骤：",
      "pos": [
        972,
        982
      ]
    },
    {
      "content": "步骤 1：创建虚拟机和可用性集",
      "pos": [
        987,
        1002
      ]
    },
    {
      "content": "步骤 2：在创建过程中将虚拟机添加到云服务中并将其分配给可用性集",
      "pos": [
        1009,
        1041
      ]
    },
    {
      "content": "步骤 3：（可选）为先前创建的虚拟机创建可用性集",
      "pos": [
        1048,
        1072
      ]
    },
    {
      "content": "步骤 4：（可选）将先前创建的虚拟机添加到可用性集中",
      "pos": [
        1079,
        1105
      ]
    },
    {
      "pos": [
        1113,
        1151
      ],
      "content": "<ph id=\"ph1\">&lt;a id=\"createset\"&gt;</ph> <ph id=\"ph2\">&lt;/a&gt;</ph>步骤 1：创建虚拟机和可用性集"
    },
    {
      "content": "若要创建包含虚拟机的可用性集，可以同时创建第一台虚拟机和可用性集，然后在创建更多虚拟机的同时，将这些虚拟机添加到可用性集中。也可以创建虚拟机，创建一个可用性集，然后将所有这些虚拟机添加到该可用性集中。",
      "pos": [
        1155,
        1255
      ]
    },
    {
      "content": "创建虚拟机和可用性集",
      "pos": [
        1257,
        1267
      ]
    },
    {
      "content": "登录到 Azure 管理门户（如果您尚未这么做）。",
      "pos": [
        1272,
        1297
      ]
    },
    {
      "content": "在命令栏上，单击“新建”。",
      "pos": [
        1302,
        1315
      ]
    },
    {
      "content": "创建虚拟机",
      "pos": [
        1323,
        1328
      ]
    },
    {
      "content": "单击“虚拟机”，然后单击“从库中”。",
      "pos": [
        1377,
        1395
      ]
    },
    {
      "content": "从“平台映像”中，选择一个映像，然后单击箭头以继续。",
      "pos": [
        1429,
        1455
      ]
    },
    {
      "content": "将显示“虚拟机配置”对话框。",
      "pos": [
        1461,
        1475
      ]
    },
    {
      "content": "在“虚拟机名称”中，键入您要用于该虚拟机的名称。",
      "pos": [
        1480,
        1504
      ]
    },
    {
      "content": "在“新用户名”中，键入要用于管理服务器的管理帐户的名称。",
      "pos": [
        1509,
        1537
      ]
    },
    {
      "content": "在“新密码”中，为管理帐户键入一个强密码。在“确认密码”中，再次键入您之前输入的密码。",
      "pos": [
        1542,
        1585
      ]
    },
    {
      "content": "在“大小”中，选择要用于该虚拟机的大小。所选大小具体取决于您应用程序所需的内核数。",
      "pos": [
        1590,
        1631
      ]
    },
    {
      "content": "单击箭头以继续。",
      "pos": [
        1636,
        1644
      ]
    },
    {
      "content": "将显示“虚拟机模式”对话框。",
      "pos": [
        1650,
        1664
      ]
    },
    {
      "content": "选择“独立虚拟机”。",
      "pos": [
        1674,
        1684
      ]
    },
    {
      "content": "在“DNS 名称”中，键入为虚拟机创建的云服务的名称。该名称可包含 3 到 24 个小写字母和数字。",
      "pos": [
        1690,
        1740
      ]
    },
    {
      "content": "在“存储帐户”中，选择存储 .vhd 文件的存储帐户，或者也可以选择自动创建存储帐户。每个区域只能自动创建一个存储帐户。使用此设置创建的所有其他虚拟机也位于该存储帐户中。您最多只能创建 20 个存储帐户。",
      "pos": [
        1746,
        1848
      ]
    },
    {
      "pos": [
        1854,
        1921
      ],
      "content": "在“区域/地缘组/虚拟网络”中，选择要包含该虚拟机的区域、地缘组或虚拟网络。有关地缘组的更多信息，请参见<bpt id=\"p1\">[</bpt>关于虚拟网络的地缘组<ept id=\"p1\">][]</ept>。"
    },
    {
      "content": "单击箭头以继续。",
      "pos": [
        1927,
        1935
      ]
    },
    {
      "content": "将显示“虚拟机选项”对话框。",
      "pos": [
        1941,
        1955
      ]
    },
    {
      "content": "在“可用性集”中，选择“创建可用性集”。",
      "pos": [
        1961,
        1981
      ]
    },
    {
      "content": "在“可用性集名称”中，输入可用性集的名称。",
      "pos": [
        1988,
        2009
      ]
    },
    {
      "content": "单击箭头以创建虚拟机和可用性集。",
      "pos": [
        2015,
        2031
      ]
    },
    {
      "content": "从新虚拟机的仪表板中，单击“配置”，您会看到该虚拟机现在是新可用性集的一个成员。",
      "pos": [
        2037,
        2077
      ]
    },
    {
      "pos": [
        2082,
        2138
      ],
      "content": "<ph id=\"ph1\">&lt;a id=\"addmachine\"&gt;</ph> <ph id=\"ph2\">&lt;/a&gt;</ph>步骤 2：在创建过程中将虚拟机添加到云服务中并将其分配给可用性集"
    },
    {
      "content": "上一步向您展示了如何同时创建虚拟机和可用性集。现在，您可以创建一台新虚拟机，将其连接到包含第一台虚拟机的云服务，然后再将其添加到先前创建的可用性集中。",
      "pos": [
        2142,
        2217
      ]
    },
    {
      "content": "连接新虚拟机并将其添加到可用性集中",
      "pos": [
        2219,
        2236
      ]
    },
    {
      "content": "登录到 Azure 管理门户（如果您尚未这么做）。",
      "pos": [
        2241,
        2266
      ]
    },
    {
      "content": "在命令栏上，单击“新建”。",
      "pos": [
        2271,
        2284
      ]
    },
    {
      "content": "创建虚拟机",
      "pos": [
        2292,
        2297
      ]
    },
    {
      "content": "单击“虚拟机”，然后单击“从库中”。",
      "pos": [
        2346,
        2364
      ]
    },
    {
      "content": "从库创建",
      "pos": [
        2372,
        2376
      ]
    },
    {
      "content": "将显示“选择虚拟机操作系统”对话框。您现在可从映像库中选择一个映像。",
      "pos": [
        2429,
        2463
      ]
    },
    {
      "content": "单击“平台映像”，选择想要使用的平台映像，然后单击箭头以继续。",
      "pos": [
        2473,
        2504
      ]
    },
    {
      "content": "将显示“虚拟机配置”对话框。",
      "pos": [
        2510,
        2524
      ]
    },
    {
      "content": "在“虚拟机名称”中，键入您要用于该虚拟机的名称。",
      "pos": [
        2529,
        2553
      ]
    },
    {
      "content": "在“新用户名”中，键入要用于管理服务器的管理帐户的名称。",
      "pos": [
        2558,
        2586
      ]
    },
    {
      "content": "在“新密码”中，为虚拟机上的管理帐户键入强密码。在“确认密码”中，重新键入密码。",
      "pos": [
        2591,
        2631
      ]
    },
    {
      "content": "在“大小”中，选择要用于该虚拟机的大小。所选大小具体取决于您应用程序所需的内核数。",
      "pos": [
        2636,
        2677
      ]
    },
    {
      "content": "对于运行 Linux 操作系统的虚拟机，您可以选择通过 SSH 密钥保护虚拟机。",
      "pos": [
        2682,
        2722
      ]
    },
    {
      "content": "单击箭头以继续。",
      "pos": [
        2728,
        2736
      ]
    },
    {
      "content": "将显示“虚拟机模式”对话框。",
      "pos": [
        2742,
        2756
      ]
    },
    {
      "content": "选择“连接到现有虚拟机”以创建一台将与可用性集中第一台虚拟机连接的新虚拟机。选择包含可用性集中该虚拟机的云服务。",
      "pos": [
        2767,
        2823
      ]
    },
    {
      "content": "在“存储帐户”中，选择存储 VHD 文件的存储帐户。",
      "pos": [
        2829,
        2855
      ]
    },
    {
      "content": "在“区域/地缘组/虚拟网络”中，选择要包含该虚拟机的区域。",
      "pos": [
        2861,
        2890
      ]
    },
    {
      "content": "单击箭头以继续。",
      "pos": [
        2896,
        2904
      ]
    },
    {
      "content": "将显示“虚拟机选项”对话框。",
      "pos": [
        2910,
        2924
      ]
    },
    {
      "content": "选择您在创建第一台虚拟机时创建的可用性集。",
      "pos": [
        2930,
        2951
      ]
    },
    {
      "content": "单击复选标记以创建已连接的虚拟机并将其添加到可用性集中。",
      "pos": [
        2957,
        2985
      ]
    },
    {
      "content": "从新虚拟机的仪表板中，单击“配置”，您会看到该虚拟机现在是新可用性集的一个成员。",
      "pos": [
        2991,
        3031
      ]
    },
    {
      "pos": [
        3036,
        3089
      ],
      "content": "<ph id=\"ph1\">&lt;a id=\"previousmachine\"&gt;</ph> <ph id=\"ph2\">&lt;/a&gt;</ph>步骤 3：（可选）为先前创建的虚拟机创建可用性集"
    },
    {
      "content": "您可以创建一个可用性集，在创建虚拟机后将其添加到该可用性集中。在创建虚拟机后，可以配置其大小以及它是否为某个可用性集的成员。",
      "pos": [
        3093,
        3155
      ]
    },
    {
      "content": "创建新的可用性集",
      "pos": [
        3157,
        3165
      ]
    },
    {
      "content": "登录到 Azure 管理门户（如果您尚未这么做）。",
      "pos": [
        3170,
        3195
      ]
    },
    {
      "content": "单击“虚拟机”，然后选择您要配置的虚拟机。",
      "pos": [
        3200,
        3221
      ]
    },
    {
      "content": "单击“配置”。",
      "pos": [
        3226,
        3233
      ]
    },
    {
      "content": "在“可用性集”部分，选择“创建可用性集”，然后输入该可用性集的名称。",
      "pos": [
        3238,
        3272
      ]
    },
    {
      "content": "单击“保存”。",
      "pos": [
        3278,
        3285
      ]
    },
    {
      "content": "注意：这可能导致虚拟机重新启动以最终确定它在可用性集中的成员身份。",
      "pos": [
        3291,
        3324
      ]
    },
    {
      "pos": [
        3329,
        3380
      ],
      "content": "<ph id=\"ph1\">&lt;a id=\"existingset\"&gt;</ph> <ph id=\"ph2\">&lt;/a&gt;</ph>步骤 4：（可选）将先前创建的虚拟机添加到可用性集中"
    },
    {
      "pos": [
        3384,
        3489
      ],
      "content": "您可以轻松地将现有虚拟机添加到先前创建的可用性集中。若要将某台虚拟机添加到可用性集中，该虚拟机必须连接到包含此可用性集中其他虚拟机的同一云服务。有关连接虚拟机的更多信息，请参见<bpt id=\"p1\">[</bpt>如何连接云服务中的虚拟机<ept id=\"p1\">][]</ept>。"
    },
    {
      "content": "将现有虚拟机添加到可用性集中",
      "pos": [
        3491,
        3505
      ]
    },
    {
      "content": "登录到 Azure 管理门户（如果您尚未这么做）。",
      "pos": [
        3510,
        3535
      ]
    },
    {
      "content": "单击“虚拟机”，然后选择要添加到可用性集中的虚拟机。",
      "pos": [
        3540,
        3566
      ]
    },
    {
      "content": "单击“配置”。",
      "pos": [
        3571,
        3578
      ]
    },
    {
      "content": "在“可用性集”部分，选择先前创建的可用性集。",
      "pos": [
        3583,
        3605
      ]
    },
    {
      "content": "单击“保存”。",
      "pos": [
        3610,
        3617
      ]
    },
    {
      "content": "注意：这可能导致虚拟机重新启动以最终确定它在可用性集中的成员身份。",
      "pos": [
        3623,
        3656
      ]
    }
  ],
  "content": "<properties writer=\"kathydav\" editor=\"tysonn\" manager=\"jeffreyg\" />\n<tags ms.service=\"\"\n    ms.date=\"10/28/2014\"\n    wacn.date=\"04/11/2015\"\n    /> \n\n#管理虚拟机的可用性#\n\n为了帮助确保您的应用程序的可用性，我们强烈建议使用可提供冗余的多台虚拟机。若要提供冗余，请配置多台虚拟机来执行相同的功能或角色。获得有保证的水平的服务需要此冗余。另请确保考虑依赖关系。例如，如果虚拟机“IIS1”依赖虚拟机“SQL1”提供的服务，“SQL2”将提供虚拟机“SQL1”的冗余来帮助避免服务中断。有关服务级别协议要求的更多信息，请参见[服务级别协议](/zh-cn/support/legal/sla)中的“云服务、虚拟机和虚拟网络”一节。\n\n此方法可帮助确保在出现本地网络故障、本地磁盘硬件故障以及平台可能需要的任何计划内停机时，应用程序仍然可用。\n\n通过将多台虚拟机添加到一个可用性集中，您可以管理使用这些虚拟机的应用程序的可用性。可用性集直接与容错域和更新域相关。通过避免单点（例如服务器机架上的网络交换机或电源设备）故障，可定义 Azure 中的容错域。事实上，容错域近似等同物理服务器机架。当多台虚拟机在云服务中连接在一起时，可用性集会将这些虚拟机放在不同的容错域中。下面的示意图显示两个可用性集，其中每个可用性集包含两台虚拟机。\n\n![更新域](./media/manage-vm-availability/UpdateDomains.png)\n\nAzure 定期更新承载应用程序实例的操作系统。在应用更新时，虚拟机将关闭。更新域用来确保不是所有虚拟机实例都在同一时间更新。当您将多台虚拟机分配到某个可用性集时，Azure 可确保这些虚拟机将分配到不同的更新域。上图显示两台运行 Internet Information Services (IIS) 的虚拟机位于不同的更新域中，两台运行 SQL Server 的虚拟机也位于不同的更新域中。\n\n应结合使用可用性集和负载平衡终结点，以帮助确保应用程序始终可用并且高效运行。有关使用负载平衡终结点的更多信息，请参见[对虚拟机进行负载平衡][]。\n\n此任务包括下列步骤：\n\n- [步骤 1：创建虚拟机和可用性集][]\n- [步骤 2：在创建过程中将虚拟机添加到云服务中并将其分配给可用性集][]\n- [步骤 3：（可选）为先前创建的虚拟机创建可用性集][]\n- [步骤 4：（可选）将先前创建的虚拟机添加到可用性集中][]\n\n## <a id=\"createset\"> </a>步骤 1：创建虚拟机和可用性集##\n\n若要创建包含虚拟机的可用性集，可以同时创建第一台虚拟机和可用性集，然后在创建更多虚拟机的同时，将这些虚拟机添加到可用性集中。也可以创建虚拟机，创建一个可用性集，然后将所有这些虚拟机添加到该可用性集中。\n\n创建虚拟机和可用性集\n\n1. 登录到 Azure 管理门户（如果您尚未这么做）。\n\n2. 在命令栏上，单击“新建”。\n\n    ![创建虚拟机](./media/manage-vm-availability/Create.png)\n\n3. 单击“虚拟机”，然后单击“从库中”。\n\n\n    将显示“选择虚拟机操作系统”对话框。\n    \n4. 从“平台映像”中，选择一个映像，然后单击箭头以继续。\n\n    将显示“虚拟机配置”对话框。\n\n5. 在“虚拟机名称”中，键入您要用于该虚拟机的名称。\n\n6. 在“新用户名”中，键入要用于管理服务器的管理帐户的名称。\n\n7. 在“新密码”中，为管理帐户键入一个强密码。在“确认密码”中，再次键入您之前输入的密码。\n\n8. 在“大小”中，选择要用于该虚拟机的大小。所选大小具体取决于您应用程序所需的内核数。\n\n9. 单击箭头以继续。\n\n    将显示“虚拟机模式”对话框。\n    \n10. 选择“独立虚拟机”。\n\n11. 在“DNS 名称”中，键入为虚拟机创建的云服务的名称。该名称可包含 3 到 24 个小写字母和数字。\n\n12. 在“存储帐户”中，选择存储 .vhd 文件的存储帐户，或者也可以选择自动创建存储帐户。每个区域只能自动创建一个存储帐户。使用此设置创建的所有其他虚拟机也位于该存储帐户中。您最多只能创建 20 个存储帐户。\n\n13. 在“区域/地缘组/虚拟网络”中，选择要包含该虚拟机的区域、地缘组或虚拟网络。有关地缘组的更多信息，请参见[关于虚拟网络的地缘组][]。\n\n14. 单击箭头以继续。\n\n    将显示“虚拟机选项”对话框。\n\n15. 在“可用性集”中，选择“创建可用性集”。\n \n16. 在“可用性集名称”中，输入可用性集的名称。\n\n17. 单击箭头以创建虚拟机和可用性集。\n\n    从新虚拟机的仪表板中，单击“配置”，您会看到该虚拟机现在是新可用性集的一个成员。\n\n## <a id=\"addmachine\"> </a>步骤 2：在创建过程中将虚拟机添加到云服务中并将其分配给可用性集##\n\n上一步向您展示了如何同时创建虚拟机和可用性集。现在，您可以创建一台新虚拟机，将其连接到包含第一台虚拟机的云服务，然后再将其添加到先前创建的可用性集中。\n\n连接新虚拟机并将其添加到可用性集中\n\n1. 登录到 Azure 管理门户（如果您尚未这么做）。\n\n2. 在命令栏上，单击“新建”。\n\n    ![创建虚拟机](./media/manage-vm-availability/Create.png)\n\n3. 单击“虚拟机”，然后单击“从库中”。\n\n    ![从库创建](./media/manage-vm-availability/CreateNew.png)\n\n    将显示“选择虚拟机操作系统”对话框。您现在可从映像库中选择一个映像。\n\n    \n4. 单击“平台映像”，选择想要使用的平台映像，然后单击箭头以继续。\n\n    将显示“虚拟机配置”对话框。\n\n5. 在“虚拟机名称”中，键入您要用于该虚拟机的名称。\n\n6. 在“新用户名”中，键入要用于管理服务器的管理帐户的名称。\n\n7. 在“新密码”中，为虚拟机上的管理帐户键入强密码。在“确认密码”中，重新键入密码。\n\n8. 在“大小”中，选择要用于该虚拟机的大小。所选大小具体取决于您应用程序所需的内核数。\n\n9. 对于运行 Linux 操作系统的虚拟机，您可以选择通过 SSH 密钥保护虚拟机。\n\n10. 单击箭头以继续。\n\n    将显示“虚拟机模式”对话框。\n\n    \n11. 选择“连接到现有虚拟机”以创建一台将与可用性集中第一台虚拟机连接的新虚拟机。选择包含可用性集中该虚拟机的云服务。\n\n12. 在“存储帐户”中，选择存储 VHD 文件的存储帐户。\n\n13. 在“区域/地缘组/虚拟网络”中，选择要包含该虚拟机的区域。\n\n14. 单击箭头以继续。\n\n    将显示“虚拟机选项”对话框。\n\n15. 选择您在创建第一台虚拟机时创建的可用性集。\n\n16. 单击复选标记以创建已连接的虚拟机并将其添加到可用性集中。\n\n    从新虚拟机的仪表板中，单击“配置”，您会看到该虚拟机现在是新可用性集的一个成员。\n\n## <a id=\"previousmachine\"> </a>步骤 3：（可选）为先前创建的虚拟机创建可用性集##\n\n您可以创建一个可用性集，在创建虚拟机后将其添加到该可用性集中。在创建虚拟机后，可以配置其大小以及它是否为某个可用性集的成员。\n\n创建新的可用性集\n\n1. 登录到 Azure 管理门户（如果您尚未这么做）。\n\n2. 单击“虚拟机”，然后选择您要配置的虚拟机。\n\n3. 单击“配置”。\n\n4. 在“可用性集”部分，选择“创建可用性集”，然后输入该可用性集的名称。\n\n\n5. 单击“保存”。\n\n    注意：这可能导致虚拟机重新启动以最终确定它在可用性集中的成员身份。\n\n## <a id=\"existingset\"> </a>步骤 4：（可选）将先前创建的虚拟机添加到可用性集中##\n\n您可以轻松地将现有虚拟机添加到先前创建的可用性集中。若要将某台虚拟机添加到可用性集中，该虚拟机必须连接到包含此可用性集中其他虚拟机的同一云服务。有关连接虚拟机的更多信息，请参见[如何连接云服务中的虚拟机][]。\n\n将现有虚拟机添加到可用性集中\n\n1. 登录到 Azure 管理门户（如果您尚未这么做）。\n\n2. 单击“虚拟机”，然后选择要添加到可用性集中的虚拟机。\n\n3. 单击“配置”。\n\n4. 在“可用性集”部分，选择先前创建的可用性集。\n\n5. 单击“保存”。\n\n    注意：这可能导致虚拟机重新启动以最终确定它在可用性集中的成员身份。\n\n\n[步骤 1：创建虚拟机和可用性集]: #createset\n[步骤 2：在创建过程中将虚拟机添加到云服务中并将其分配给可用性集]: #addmachine\n[步骤 3：（可选）为先前创建的虚拟机创建可用性集]: #previousmachine\n[步骤 4：（可选）将先前创建的虚拟机添加到可用性集中]: #existingset\n\n\n<!-- LINKS -->\n\n[对虚拟机进行负载平衡]: /documentation/articles/load-balance-virtual-machines\n[关于虚拟网络的地缘组]:https://msdn.microsoft.com/zh-CN/library/windowsazure/jj156085.aspx\n[如何连接云服务中的虚拟机]: /documentation/articles/virtual-machines-connect-cloud-service\n"
}